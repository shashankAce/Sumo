{"version":3,"sources":["file:///D:/Office/Sumo/assets/Script/Player.ts"],"names":["_decorator","Component","Vec3","Node","macro","ccclass","property","CELL_TIME","SPEED","Player","type","ZERO","touchCallBack","vector","angle","rotateZ","playerCamera","eulerAngles","y","RAD","_vector","normalize","node","touchAngleCallBack","_vectorAngle","fix_update","dt","lengthSqr","setPosition","position","add3f","x","update","deltaTime","_now_time"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;;;;;;;AACpCC,MAAAA,O,GAAsBL,U,CAAtBK,O;AAASC,MAAAA,Q,GAAaN,U,CAAbM,Q;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACMC,MAAAA,S,GAAY,K;AACZC,MAAAA,K,GAAQ,C;;wBAGDC,M,WADZJ,OAAO,CAAC,QAAD,C,UAIHC,QAAQ,CAAC;AAAEI,QAAAA,IAAI,EAAEP;AAAR,OAAD,C;;;;;;;;;;;;;;oEAEeD,IAAI,CAACS,I;;yEACAT,IAAI,CAACS,I;;sEACd,C;;;;;;;eAEpBC,a,GAAA,uBAAcC,MAAd,EAA4BC,KAA5B,EAA2C;AACvCZ,UAAAA,IAAI,CAACa,OAAL,CAAaF,MAAb,EAAqBA,MAArB,EAA6BX,IAAI,CAACS,IAAlC,EAAwC,KAAKK,YAAL,CAAkBC,WAAlB,CAA8BC,CAA9B,GAAkCd,KAAK,CAACe,GAAhF;AACA,eAAKC,OAAL,GAAeP,MAAM,CAACQ,SAAP,EAAf;;AAEA,cAAIP,KAAJ,EAAW;AACP,iBAAKQ,IAAL,CAAUL,WAAV,GAAwB,IAAIf,IAAJ,CAAS,CAAT,EAAYY,KAAK,GAAG,EAAR,GAAa,KAAKE,YAAL,CAAkBC,WAAlB,CAA8BC,CAAvD,EAA0D,CAA1D,CAAxB;AACH;AACJ,S;;eAEDK,kB,GAAA,4BAAmBV,MAAnB,EAAiCC,KAAjC,EAAgD;AAC5C,eAAKU,YAAL,GAAoBX,MAAM,CAACQ,SAAP,EAApB;AACH,S;;eAEDI,U,GAAA,oBAAWC,EAAX,EAAuB;AACnB,cAAI,KAAKN,OAAL,CAAaO,SAAb,KAA2B,CAA/B,EAAkC;AAC9B,iBAAKL,IAAL,CAAUM,WAAV,CAAsB,KAAKN,IAAL,CAAUO,QAAV,CAAmBC,KAAnB,CAAyB,KAAKV,OAAL,CAAaW,CAAb,GAAiBvB,KAAjB,GAAyBkB,EAAlD,EAAsD,CAAtD,EAAyD,CAAC,KAAKN,OAAL,CAAaF,CAAd,GAAkBV,KAAlB,GAA0BkB,EAAnF,CAAtB;AACA,iBAAKV,YAAL,CAAkBY,WAAlB,CAA8B,KAAKZ,YAAL,CAAkBa,QAAlB,CAA2BC,KAA3B,CAAiC,KAAKV,OAAL,CAAaW,CAAb,GAAiBvB,KAAjB,GAAyBkB,EAA1D,EAA8D,CAA9D,EAAiE,CAAjE,CAA9B;AACH;;AAED,cAAI,KAAKF,YAAL,CAAkBG,SAAlB,KAAgC,CAApC,EAAuC;AACnC,iBAAKX,YAAL,CAAkBC,WAAlB,GAAgC,KAAKD,YAAL,CAAkBC,WAAlB,CAA8Ba,KAA9B,CAAoC,CAApC,EAAuC,CAAC,KAAKN,YAAL,CAAkBO,CAA1D,EAA6D,CAA7D,CAAhC;AACH;AACJ,S;;eAEDC,M,GAAA,gBAAOC,SAAP,EAA0B;AACtB,eAAKC,SAAL,IAAkBD,SAAlB;;AACA,iBAAO,KAAKC,SAAL,IAAkB3B,SAAzB,EAAoC;AAChC,iBAAKkB,UAAL,CAAgBlB,SAAhB;AACA,iBAAK2B,SAAL,IAAkB3B,SAAlB;AACH;AACJ,S;;;QAvCuBN,S;;;;;iBAIH,I","sourcesContent":["\r\nimport { _decorator, Component, Vec3, Node, macro } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = Player\r\n * DateTime = Fri Sep 24 2021 14:15:01 GMT+0530 (India Standard Time)\r\n * Author = shashankA\r\n * FileBasename = Player.ts\r\n * FileBasenameNoExtension = Player\r\n * URL = db://assets/Script/Player.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\nconst CELL_TIME = 0.016;\r\nconst SPEED = 4;\r\n\r\n@ccclass('Player')\r\nexport class Player extends Component {\r\n\r\n\r\n    @property({ type: Node })\r\n    playerCamera: Node = null;\r\n    private _vector: Vec3 = Vec3.ZERO;\r\n    private _vectorAngle: Vec3 = Vec3.ZERO;\r\n    private _now_time = 0;\r\n\r\n    touchCallBack(vector: Vec3, angle: number) {\r\n        Vec3.rotateZ(vector, vector, Vec3.ZERO, this.playerCamera.eulerAngles.y * macro.RAD);\r\n        this._vector = vector.normalize();\r\n        \r\n        if (angle) {\r\n            this.node.eulerAngles = new Vec3(0, angle + 90 + this.playerCamera.eulerAngles.y, 0);\r\n        }\r\n    }\r\n\r\n    touchAngleCallBack(vector: Vec3, angle: number) {\r\n        this._vectorAngle = vector.normalize();\r\n    }\r\n\r\n    fix_update(dt: number) {\r\n        if (this._vector.lengthSqr() > 0) {\r\n            this.node.setPosition(this.node.position.add3f(this._vector.x * SPEED * dt, 0, -this._vector.y * SPEED * dt));\r\n            this.playerCamera.setPosition(this.playerCamera.position.add3f(this._vector.x * SPEED * dt, 0, 0));\r\n        }\r\n\r\n        if (this._vectorAngle.lengthSqr() > 0) {\r\n            this.playerCamera.eulerAngles = this.playerCamera.eulerAngles.add3f(0, -this._vectorAngle.x, 0);\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this._now_time += deltaTime;\r\n        while (this._now_time >= CELL_TIME) {\r\n            this.fix_update(CELL_TIME);\r\n            this._now_time -= CELL_TIME;\r\n        }\r\n    }\r\n}"]}