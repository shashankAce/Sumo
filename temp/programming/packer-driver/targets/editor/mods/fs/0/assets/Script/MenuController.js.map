{"version":3,"sources":["file:///D:/Office/Sumo/assets/Script/MenuController.ts"],"names":["_decorator","Component","systemEvent","SystemEvent","director","macro","Node","Vec3","ccclass","property","MenuController","type","onLoad","ENABLE_MULTI_TOUCH","preloadScene","start","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","touch","startLoc","getLocation","startZ","sumo","rotation","getEulerAngles","z","loc","getLocationX","dist","x","setRotationFromEuler","startGame","loadScene","onDestroy","off"],"mappings":";;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAgCC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,K,OAAAA,K;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;;;;;;OAEpG;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;gCAGjBU,c,WADZF,OAAO,CAAC,gBAAD,C,UAMHC,QAAQ,CAAC;AACNE,QAAAA,IAAI,EAAEL;AADA,OAAD,C,oCANb,MACaI,cADb,SACoCT,SADpC,CAC8C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAU1CW,QAAAA,MAAM,GAAG;AAELP,UAAAA,KAAK,CAACQ,kBAAN,GAA2B,KAA3B;AACAT,UAAAA,QAAQ,CAACU,YAAT,CAAsB,WAAtB;AACH;;AAEDC,QAAAA,KAAK,GAAG;AACJ;AACAb,UAAAA,WAAW,CAACc,EAAZ,CAAeb,WAAW,CAACc,SAAZ,CAAsBC,WAArC,EAAkD,KAAKC,UAAvD,EAAmE,IAAnE;AACAjB,UAAAA,WAAW,CAACc,EAAZ,CAAeb,WAAW,CAACc,SAAZ,CAAsBG,UAArC,EAAiD,KAAKC,SAAtD,EAAiE,IAAjE;AACH;;AAEDF,QAAAA,UAAU,CAACG,KAAD,EAAe;AACrB,eAAKC,QAAL,GAAgBD,KAAK,CAACE,WAAN,EAAhB;AACA,eAAKC,MAAL,GAAc,KAAKC,IAAL,CAAUC,QAAV,CAAmBC,cAAnB,CAAkC,IAAIrB,IAAJ,EAAlC,EAA8CsB,CAA5D;AACH;;AAEDR,QAAAA,SAAS,CAACC,KAAD,EAAe;AACpB,cAAIQ,GAAG,GAAGR,KAAK,CAACS,YAAN,EAAV;AACA,cAAIC,IAAI,GAAG,KAAKT,QAAL,CAAcU,CAAd,GAAkBH,GAA7B,CAFoB,CAGpB;AACA;;AACA,eAAKJ,IAAL,CAAUQ,oBAAV,CAA+B,CAAC,EAAhC,EAAoC,CAApC,EAAuC,KAAKT,MAAL,GAAcO,IAArD;AACH;;AAEDG,QAAAA,SAAS,GAAS;AACd/B,UAAAA,QAAQ,CAACgC,SAAT,CAAmB,WAAnB;AACH;;AAEDC,QAAAA,SAAS,GAAG;AACRnC,UAAAA,WAAW,CAACoC,GAAZ,CAAgBnC,WAAW,CAACc,SAAZ,CAAsBC,WAAtC,EAAmD,KAAKC,UAAxD,EAAoE,IAApE;AACAjB,UAAAA,WAAW,CAACoC,GAAZ,CAAgBnC,WAAW,CAACc,SAAZ,CAAsBG,UAAtC,EAAkD,KAAKC,SAAvD,EAAkE,IAAlE;AACH;;AA1CyC,O","sourcesContent":["\r\nimport { _decorator, Component, systemEvent, SystemEvent, EventTouch, Touch, director, macro, Vec2, Node, Vec3, Quat, clamp, Prefab, log } from 'cc';\r\nimport { Sumo } from './Sumo';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('MenuController')\r\nexport class MenuController extends Component {\r\n\r\n    startLoc: Vec2;\r\n    startZ: number;\r\n\r\n    @property({\r\n        type: Node\r\n    })\r\n    sumo: Node;\r\n\r\n    onLoad() {\r\n\r\n        macro.ENABLE_MULTI_TOUCH = false;\r\n        director.preloadScene('GameScene');\r\n    }\r\n\r\n    start() {\r\n        // Created for rotating the character\r\n        systemEvent.on(SystemEvent.EventType.TOUCH_START, this.touchStart, this);\r\n        systemEvent.on(SystemEvent.EventType.TOUCH_MOVE, this.touchMove, this);\r\n    }\r\n\r\n    touchStart(touch: Touch) {\r\n        this.startLoc = touch.getLocation();\r\n        this.startZ = this.sumo.rotation.getEulerAngles(new Vec3()).z;\r\n    }\r\n\r\n    touchMove(touch: Touch) {\r\n        let loc = touch.getLocationX();\r\n        let dist = this.startLoc.x - loc;\r\n        // let angle = clamp(dist, -360, 360);\r\n        // let endQuat = Quat.fromEuler(new Quat(), -90, 0, angle);\r\n        this.sumo.setRotationFromEuler(-90, 0, this.startZ + dist);\r\n    }\r\n\r\n    startGame(): void {\r\n        director.loadScene('GameScene');\r\n    }\r\n\r\n    onDestroy() {\r\n        systemEvent.off(SystemEvent.EventType.TOUCH_START, this.touchStart, this);\r\n        systemEvent.off(SystemEvent.EventType.TOUCH_MOVE, this.touchMove, this);\r\n    }\r\n}"]}