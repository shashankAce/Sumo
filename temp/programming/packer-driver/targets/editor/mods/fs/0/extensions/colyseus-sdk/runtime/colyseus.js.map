{"version":3,"sources":["file:///D:/Office/Sumo/extensions/colyseus-sdk/runtime/colyseus.js"],"names":["global","factory","exports","module","define","amd","globalThis","self","Colyseus","ArrayBuffer","isView","a","buffer","window","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","pop","length","push","src","tar","headers","statusMessage","statusText","statusCode","status","data","response","send","method","uri","opts","res","rej","req","XMLHttpRequest","k","tmp","arr","str","timeout","ontimeout","onerror","err","type","open","href","onload","getAllResponseHeaders","trim","split","shift","toLowerCase","join","indexOf","JSON","parse","reviver","FormData","stringify","withCredentials","setRequestHeader","get","bind","post","patch","del","put","del_1","get_1","patch_1","post_1","put_1","send_1","xhr","http","freeze","assign","ServerError","_super","code","message","_this","name","Error","Decoder","offset","_offset","_buffer","_view","DataView","byteOffset","byteLength","utf8Read$1","view","string","chr","i","end","byte","getUint8","fromCharCode","toString","_array","_parse","_map","key","_str","_bin","slice","prefix","hi","lo","getUint16","getUint32","getInt8","getFloat32","getFloat64","Math","pow","getInt16","getInt32","Date","decode","decoder","utf8Write","c","l","charCodeAt","setUint8","utf8Length$1","_encode","bytes","defers","size","_length","floor","isFinite","_float","isArray","time","getTime","toJSON","keys","allKeys","encode","buf","deferIndex","deferWritten","nextOffset","defer","deferLength","bin","Uint8Array","j","undefined","setFloat64","browser","WebSocket","WebSocketTransport","events","ws","connect","url","protocols","binaryType","onopen","onmessage","onclose","close","reason","Connection","transport","serializers","registerSerializer","id","serializer","getSerializer","Protocol","ErrorCode","utf8Read","utf8Length","createNanoEvents","emit","event","args","forEach","on","cb","filter","EventEmitter","handlers","register","once","invoke","_i","arguments","handler","invokeAsync","all","map","remove","index","clear","createSignal","emitter","callback","commonjsGlobal","createCommonjsModule","fn","umd","__decorate","decorators","target","desc","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__spreadArray","to","from","il","SWITCH_TO_STRUCTURE","TYPE_ID","OPERATION","Root","refs","Map","refCounts","deletedRefs","Set","nextUniqueId","getNextUniqueId","addRef","refId","ref","incrementCount","set","removeRef","add","clearRefs","garbageCollectDeletedRefs","Schema","fieldName","schema","definition","parent","_definition","fieldsByIndex","parentIndex","values","child","delete","ChangeTree","root","changed","changes","allChanges","caches","currentCustomOperation","setParent","indexes","field","parentIndex_1","changeTreee","parentIndex_2","operation","change","ADD","assertValidIndex","previousChange","DELETE","TOUCH","DELETE_AND_ADD","touchParents","touch","has","getType","parentType","getChildrenFilter","childFilters","getValue","console","warn","previousValue","discard","discardAll","cache","cachedBytes","clone","ensureRefId","DEFAULT_SORT","A","B","getArrayProxy","Proxy","obj","prop","isNaN","at","setValue","parseInt","deleteAt","setAt","deleteProperty","ArraySchema","items","$changes","$items","$indexes","$refId","is","splice","enumerable","configurable","lastIndex","_a","_b","$deleteAt","isDecoding","item","CLEAR","concat","separator","reverse","reversedItems","shiftAt","start","sort","compareFn","sortedItems","deleteCount","removedItems","unshift","addedLength","previousValues","searchElement","fromIndex","lastIndexOf","every","callbackfn","some","reduce","initialValue","reduceRight","find","predicate","findIndex","fill","copyWithin","toLocaleString","unscopables","entries","includes","flatMap","flat","depth","setIndex","getIndex","getByIndex","deleteByIndex","toArray","cloned","triggerAll","getMapProxy","MapSchema","initialValues","toStringTag","hasIndex","REPLACE","isRef","registeredTypes","registerType","identifier","SchemaDefinition","deprecated","descriptors","addField","getNextFieldIndex","array","addFilter","filters","indexesWithFilters","addChildrenFilter","hasFilter","klass","_context","useFilters","Context","types","schemas","typeid","_typeid","context","globalContext","definitionAtLine","stack","isMap","childType","fieldCached","writable","filterChildren","throws","defineTypes","fields","int8$1","uint8$1","int16$1","uint16$1","int32$1","uint32$1","b4","b3","b2","b1","int64$1","high","low","uint64$1","float32$1","writeFloat32","float64$1","writeFloat64","_int32$1","Int32Array","_float32$1","Float32Array","_float64$1","Float64Array","boolean$1","string$1","number$1","Number","MAX_SAFE_INTEGER","int8","uint8","int16","uint16","int32","uint32","int64","uint64","float32","float64","boolean","number","error","it","readFloat32","readFloat64","_int32","_float32","_float64","stringCheck","numberCheck","arrayCheck","switchStructureCheck","CollectionSchema","entry","SetSchema","EventEmitter_","ClientState","refIds","WeakSet","containerIndexes","WeakMap","addRefId","changeTree","client","$filterState","EncodeSchemaError","assertType","typeofTarget","allowNull","log","foundValue","assertInstanceType","encodePrimitiveType","encodeFunc","decodePrimitiveType","defineProperties","$listeners","onError","props","listen","attr","$root","totalBytes","nextRef","isSchema","fieldIndex","dynamicIndex","nextIterator","refId_1","getSchemaType","createTypeInstance","onChange","onRemove","typeDef","refId_2","valueRef","onAdd","deletes","iter","value_1","getProxy","hasChange","_triggerChanges","encodeAll","rootChangeTree","refIdsVisited","changeTrees","numChangeTrees","cl","beginIndex","tryEncodeTypeId","applyFilters","refIdsDissallowed","filteredBytes","_loop_1","clientHasRefId","isEncodeAll","indexWithFilter","_triggerAllFillChanges","discardAllChanges","targetType","defaultType","instance","_field","_c","_d","_e","_f","_g","_h","_j","_k","_l","_m","listener","dumpChanges","dump","currentStructure","reflectionContext","ReflectionField","ReflectionType","Reflection","rootSchemaType","reflection","rootType","buildType","currentType","fieldType","type_1","childTypeSchema","referencedType","type_2","schemaTypes","reflectionType","schemaType","refType","typeInfo","rootInstance","Room","rootSchema","onStateChange","onLeave","onJoin","hasJoined","onMessageHandlers","state","removeAllListeners","endpoint","connection","onMessageCallback","destroy","leave","consented","LEAVE_ROOM","onMessage","getMessageHandlerKey","initialBytes","ROOM_DATA","encoded","getState","JOIN_ROOM","serializerId","handshake","ERROR","it_1","code_1","ROOM_DATA_SCHEMA","it_2","context_1","dispatchMessage","ROOM_STATE","setState","ROOM_STATE_PATCH","it_3","encodedState","binaryPatch","messageType","teardown","storage","getStorage","cc","sys","localStorage","setItem","getItem","removeItem","TOKEN_STORAGE","Platform","Auth","_id","username","displayName","avatarUrl","isAnonymous","email","lang","location","timezone","metadata","devices","facebookId","twitterId","googleId","gameCenterId","steamId","friendIds","blockedUserIds","createdAt","updatedAt","token","replace","login","options","queryParams","hasToken","request","registerPingService","save","getFriends","getOnlineFriends","getFriendRequests","sendFriendRequest","friendId","userId","acceptFriendRequest","declineFriendRequest","blockUser","unblockUser","segments","query","name_1","queryString","logout","unregisterPingService","keepOnlineInterval","setInterval","clearInterval","MatchMakeError","DEFAULT_ENDPOINT","hostname","protocol","port","Client","_auth","joinOrCreate","roomName","createMatchMakeRequest","joinById","roomId","reconnect","sessionId","getAvailableRooms","consumeSeatReservation","room","createRoom","buildEndpoint","params","processId","SchemaSerializer","rawState","patches","NoneSerializer"],"mappings":"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","sourcesContent":["// colyseus.js@0.14.12 (@colyseus/schema 1.0.22)\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define('colyseus.js', ['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.Colyseus = {}));\n}(this, (function (exports) { 'use strict';\n\n    //\n    // Polyfills for legacy environments\n    //\n    /*\n     * Support Android 4.4.x\n     */\n    if (!ArrayBuffer.isView) {\n        ArrayBuffer.isView = function (a) {\n            return a !== null && typeof (a) === 'object' && a.buffer instanceof ArrayBuffer;\n        };\n    }\n    // Define globalThis if not available.\n    // https://github.com/colyseus/colyseus.js/issues/86\n    if (typeof (globalThis) === \"undefined\" &&\n        typeof (window) !== \"undefined\") {\n        // @ts-ignore\n        window['globalThis'] = window;\n    }\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    }\n\n    function apply(src, tar) {\n    \ttar.headers = src.headers || {};\n    \ttar.statusMessage = src.statusText;\n    \ttar.statusCode = src.status;\n    \ttar.data = src.response;\n    }\n\n    function send(method, uri, opts) {\n    \treturn new Promise(function (res, rej) {\n    \t\topts = opts || {};\n    \t\tvar req = new XMLHttpRequest;\n    \t\tvar k, tmp, arr, str=opts.body;\n    \t\tvar headers = opts.headers || {};\n\n    \t\t// IE compatible\n    \t\tif (opts.timeout) req.timeout = opts.timeout;\n    \t\treq.ontimeout = req.onerror = function (err) {\n    \t\t\terr.timeout = err.type == 'timeout';\n    \t\t\trej(err);\n    \t\t};\n\n    \t\treq.open(method, uri.href || uri);\n\n    \t\treq.onload = function () {\n    \t\t\tarr = req.getAllResponseHeaders().trim().split(/[\\r\\n]+/);\n    \t\t\tapply(req, req); //=> req.headers\n\n    \t\t\twhile (tmp = arr.shift()) {\n    \t\t\t\ttmp = tmp.split(': ');\n    \t\t\t\treq.headers[tmp.shift().toLowerCase()] = tmp.join(': ');\n    \t\t\t}\n\n    \t\t\ttmp = req.headers['content-type'];\n    \t\t\tif (tmp && !!~tmp.indexOf('application/json')) {\n    \t\t\t\ttry {\n    \t\t\t\t\treq.data = JSON.parse(req.data, opts.reviver);\n    \t\t\t\t} catch (err) {\n    \t\t\t\t\tapply(req, err);\n    \t\t\t\t\treturn rej(err);\n    \t\t\t\t}\n    \t\t\t}\n\n    \t\t\t(req.status >= 400 ? rej : res)(req);\n    \t\t};\n\n    \t\tif (typeof FormData < 'u' && str instanceof FormData) ; else if (str && typeof str == 'object') {\n    \t\t\theaders['content-type'] = 'application/json';\n    \t\t\tstr = JSON.stringify(str);\n    \t\t}\n\n    \t\treq.withCredentials = !!opts.withCredentials;\n\n    \t\tfor (k in headers) {\n    \t\t\treq.setRequestHeader(k, headers[k]);\n    \t\t}\n\n    \t\treq.send(str);\n    \t});\n    }\n\n    var get = /*#__PURE__*/ send.bind(send, 'GET');\n    var post = /*#__PURE__*/ send.bind(send, 'POST');\n    var patch = /*#__PURE__*/ send.bind(send, 'PATCH');\n    var del = /*#__PURE__*/ send.bind(send, 'DELETE');\n    var put = /*#__PURE__*/ send.bind(send, 'PUT');\n\n    var del_1 = del;\n    var get_1 = get;\n    var patch_1 = patch;\n    var post_1 = post;\n    var put_1 = put;\n    var send_1 = send;\n\n    var xhr = {\n    \tdel: del_1,\n    \tget: get_1,\n    \tpatch: patch_1,\n    \tpost: post_1,\n    \tput: put_1,\n    \tsend: send_1\n    };\n\n    var http = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.assign(/*#__PURE__*/Object.create(null), xhr, {\n        'default': xhr,\n        del: del_1,\n        get: get_1,\n        patch: patch_1,\n        post: post_1,\n        put: put_1,\n        send: send_1\n    }));\n\n    var ServerError = /** @class */ (function (_super) {\n        __extends(ServerError, _super);\n        function ServerError(code, message) {\n            var _this = _super.call(this, message) || this;\n            _this.name = \"ServerError\";\n            _this.code = code;\n            return _this;\n        }\n        return ServerError;\n    }(Error));\n\n    /**\n     * Copyright (c) 2014 Ion Drive Software Ltd.\n     * https://github.com/darrachequesne/notepack/\n     *\n     * Permission is hereby granted, free of charge, to any person obtaining a copy\n     * of this software and associated documentation files (the \"Software\"), to deal\n     * in the Software without restriction, including without limitation the rights\n     * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n     * copies of the Software, and to permit persons to whom the Software is\n     * furnished to do so, subject to the following conditions:\n     *\n     * The above copyright notice and this permission notice shall be included in all\n     * copies or substantial portions of the Software.\n     *\n     * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n     * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n     * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n     * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n     * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n     * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n     * SOFTWARE.\n     */\n    /**\n     * Patch for Colyseus:\n     * -------------------\n     *\n     * added `offset` on Decoder constructor, for messages arriving with a code\n     * before actual msgpack data\n     */\n    // \n    // DECODER\n    // \n    function Decoder(buffer, offset) {\n        this._offset = offset;\n        if (buffer instanceof ArrayBuffer) {\n            this._buffer = buffer;\n            this._view = new DataView(this._buffer);\n        }\n        else if (ArrayBuffer.isView(buffer)) {\n            this._buffer = buffer.buffer;\n            this._view = new DataView(this._buffer, buffer.byteOffset, buffer.byteLength);\n        }\n        else {\n            throw new Error('Invalid argument');\n        }\n    }\n    function utf8Read$1(view, offset, length) {\n        var string = '', chr = 0;\n        for (var i = offset, end = offset + length; i < end; i++) {\n            var byte = view.getUint8(i);\n            if ((byte & 0x80) === 0x00) {\n                string += String.fromCharCode(byte);\n                continue;\n            }\n            if ((byte & 0xe0) === 0xc0) {\n                string += String.fromCharCode(((byte & 0x1f) << 6) |\n                    (view.getUint8(++i) & 0x3f));\n                continue;\n            }\n            if ((byte & 0xf0) === 0xe0) {\n                string += String.fromCharCode(((byte & 0x0f) << 12) |\n                    ((view.getUint8(++i) & 0x3f) << 6) |\n                    ((view.getUint8(++i) & 0x3f) << 0));\n                continue;\n            }\n            if ((byte & 0xf8) === 0xf0) {\n                chr = ((byte & 0x07) << 18) |\n                    ((view.getUint8(++i) & 0x3f) << 12) |\n                    ((view.getUint8(++i) & 0x3f) << 6) |\n                    ((view.getUint8(++i) & 0x3f) << 0);\n                if (chr >= 0x010000) { // surrogate pair\n                    chr -= 0x010000;\n                    string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n                }\n                else {\n                    string += String.fromCharCode(chr);\n                }\n                continue;\n            }\n            throw new Error('Invalid byte ' + byte.toString(16));\n        }\n        return string;\n    }\n    Decoder.prototype._array = function (length) {\n        var value = new Array(length);\n        for (var i = 0; i < length; i++) {\n            value[i] = this._parse();\n        }\n        return value;\n    };\n    Decoder.prototype._map = function (length) {\n        var key = '', value = {};\n        for (var i = 0; i < length; i++) {\n            key = this._parse();\n            value[key] = this._parse();\n        }\n        return value;\n    };\n    Decoder.prototype._str = function (length) {\n        var value = utf8Read$1(this._view, this._offset, length);\n        this._offset += length;\n        return value;\n    };\n    Decoder.prototype._bin = function (length) {\n        var value = this._buffer.slice(this._offset, this._offset + length);\n        this._offset += length;\n        return value;\n    };\n    Decoder.prototype._parse = function () {\n        var prefix = this._view.getUint8(this._offset++);\n        var value, length = 0, type = 0, hi = 0, lo = 0;\n        if (prefix < 0xc0) {\n            // positive fixint\n            if (prefix < 0x80) {\n                return prefix;\n            }\n            // fixmap\n            if (prefix < 0x90) {\n                return this._map(prefix & 0x0f);\n            }\n            // fixarray\n            if (prefix < 0xa0) {\n                return this._array(prefix & 0x0f);\n            }\n            // fixstr\n            return this._str(prefix & 0x1f);\n        }\n        // negative fixint\n        if (prefix > 0xdf) {\n            return (0xff - prefix + 1) * -1;\n        }\n        switch (prefix) {\n            // nil\n            case 0xc0:\n                return null;\n            // false\n            case 0xc2:\n                return false;\n            // true\n            case 0xc3:\n                return true;\n            // bin\n            case 0xc4:\n                length = this._view.getUint8(this._offset);\n                this._offset += 1;\n                return this._bin(length);\n            case 0xc5:\n                length = this._view.getUint16(this._offset);\n                this._offset += 2;\n                return this._bin(length);\n            case 0xc6:\n                length = this._view.getUint32(this._offset);\n                this._offset += 4;\n                return this._bin(length);\n            // ext\n            case 0xc7:\n                length = this._view.getUint8(this._offset);\n                type = this._view.getInt8(this._offset + 1);\n                this._offset += 2;\n                return [type, this._bin(length)];\n            case 0xc8:\n                length = this._view.getUint16(this._offset);\n                type = this._view.getInt8(this._offset + 2);\n                this._offset += 3;\n                return [type, this._bin(length)];\n            case 0xc9:\n                length = this._view.getUint32(this._offset);\n                type = this._view.getInt8(this._offset + 4);\n                this._offset += 5;\n                return [type, this._bin(length)];\n            // float\n            case 0xca:\n                value = this._view.getFloat32(this._offset);\n                this._offset += 4;\n                return value;\n            case 0xcb:\n                value = this._view.getFloat64(this._offset);\n                this._offset += 8;\n                return value;\n            // uint\n            case 0xcc:\n                value = this._view.getUint8(this._offset);\n                this._offset += 1;\n                return value;\n            case 0xcd:\n                value = this._view.getUint16(this._offset);\n                this._offset += 2;\n                return value;\n            case 0xce:\n                value = this._view.getUint32(this._offset);\n                this._offset += 4;\n                return value;\n            case 0xcf:\n                hi = this._view.getUint32(this._offset) * Math.pow(2, 32);\n                lo = this._view.getUint32(this._offset + 4);\n                this._offset += 8;\n                return hi + lo;\n            // int\n            case 0xd0:\n                value = this._view.getInt8(this._offset);\n                this._offset += 1;\n                return value;\n            case 0xd1:\n                value = this._view.getInt16(this._offset);\n                this._offset += 2;\n                return value;\n            case 0xd2:\n                value = this._view.getInt32(this._offset);\n                this._offset += 4;\n                return value;\n            case 0xd3:\n                hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n                lo = this._view.getUint32(this._offset + 4);\n                this._offset += 8;\n                return hi + lo;\n            // fixext\n            case 0xd4:\n                type = this._view.getInt8(this._offset);\n                this._offset += 1;\n                if (type === 0x00) {\n                    this._offset += 1;\n                    return void 0;\n                }\n                return [type, this._bin(1)];\n            case 0xd5:\n                type = this._view.getInt8(this._offset);\n                this._offset += 1;\n                return [type, this._bin(2)];\n            case 0xd6:\n                type = this._view.getInt8(this._offset);\n                this._offset += 1;\n                return [type, this._bin(4)];\n            case 0xd7:\n                type = this._view.getInt8(this._offset);\n                this._offset += 1;\n                if (type === 0x00) {\n                    hi = this._view.getInt32(this._offset) * Math.pow(2, 32);\n                    lo = this._view.getUint32(this._offset + 4);\n                    this._offset += 8;\n                    return new Date(hi + lo);\n                }\n                return [type, this._bin(8)];\n            case 0xd8:\n                type = this._view.getInt8(this._offset);\n                this._offset += 1;\n                return [type, this._bin(16)];\n            // str\n            case 0xd9:\n                length = this._view.getUint8(this._offset);\n                this._offset += 1;\n                return this._str(length);\n            case 0xda:\n                length = this._view.getUint16(this._offset);\n                this._offset += 2;\n                return this._str(length);\n            case 0xdb:\n                length = this._view.getUint32(this._offset);\n                this._offset += 4;\n                return this._str(length);\n            // array\n            case 0xdc:\n                length = this._view.getUint16(this._offset);\n                this._offset += 2;\n                return this._array(length);\n            case 0xdd:\n                length = this._view.getUint32(this._offset);\n                this._offset += 4;\n                return this._array(length);\n            // map\n            case 0xde:\n                length = this._view.getUint16(this._offset);\n                this._offset += 2;\n                return this._map(length);\n            case 0xdf:\n                length = this._view.getUint32(this._offset);\n                this._offset += 4;\n                return this._map(length);\n        }\n        throw new Error('Could not parse');\n    };\n    function decode(buffer, offset) {\n        if (offset === void 0) { offset = 0; }\n        var decoder = new Decoder(buffer, offset);\n        var value = decoder._parse();\n        if (decoder._offset !== buffer.byteLength) {\n            throw new Error((buffer.byteLength - decoder._offset) + ' trailing bytes');\n        }\n        return value;\n    }\n    // \n    // ENCODER\n    // \n    function utf8Write(view, offset, str) {\n        var c = 0;\n        for (var i = 0, l = str.length; i < l; i++) {\n            c = str.charCodeAt(i);\n            if (c < 0x80) {\n                view.setUint8(offset++, c);\n            }\n            else if (c < 0x800) {\n                view.setUint8(offset++, 0xc0 | (c >> 6));\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\n            }\n            else if (c < 0xd800 || c >= 0xe000) {\n                view.setUint8(offset++, 0xe0 | (c >> 12));\n                view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\n            }\n            else {\n                i++;\n                c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n                view.setUint8(offset++, 0xf0 | (c >> 18));\n                view.setUint8(offset++, 0x80 | (c >> 12) & 0x3f);\n                view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\n            }\n        }\n    }\n    function utf8Length$1(str) {\n        var c = 0, length = 0;\n        for (var i = 0, l = str.length; i < l; i++) {\n            c = str.charCodeAt(i);\n            if (c < 0x80) {\n                length += 1;\n            }\n            else if (c < 0x800) {\n                length += 2;\n            }\n            else if (c < 0xd800 || c >= 0xe000) {\n                length += 3;\n            }\n            else {\n                i++;\n                length += 4;\n            }\n        }\n        return length;\n    }\n    function _encode(bytes, defers, value) {\n        var type = typeof value, i = 0, l = 0, hi = 0, lo = 0, length = 0, size = 0;\n        if (type === 'string') {\n            length = utf8Length$1(value);\n            // fixstr\n            if (length < 0x20) {\n                bytes.push(length | 0xa0);\n                size = 1;\n            }\n            // str 8\n            else if (length < 0x100) {\n                bytes.push(0xd9, length);\n                size = 2;\n            }\n            // str 16\n            else if (length < 0x10000) {\n                bytes.push(0xda, length >> 8, length);\n                size = 3;\n            }\n            // str 32\n            else if (length < 0x100000000) {\n                bytes.push(0xdb, length >> 24, length >> 16, length >> 8, length);\n                size = 5;\n            }\n            else {\n                throw new Error('String too long');\n            }\n            defers.push({ _str: value, _length: length, _offset: bytes.length });\n            return size + length;\n        }\n        if (type === 'number') {\n            // TODO: encode to float 32?\n            // float 64\n            if (Math.floor(value) !== value || !isFinite(value)) {\n                bytes.push(0xcb);\n                defers.push({ _float: value, _length: 8, _offset: bytes.length });\n                return 9;\n            }\n            if (value >= 0) {\n                // positive fixnum\n                if (value < 0x80) {\n                    bytes.push(value);\n                    return 1;\n                }\n                // uint 8\n                if (value < 0x100) {\n                    bytes.push(0xcc, value);\n                    return 2;\n                }\n                // uint 16\n                if (value < 0x10000) {\n                    bytes.push(0xcd, value >> 8, value);\n                    return 3;\n                }\n                // uint 32\n                if (value < 0x100000000) {\n                    bytes.push(0xce, value >> 24, value >> 16, value >> 8, value);\n                    return 5;\n                }\n                // uint 64\n                hi = (value / Math.pow(2, 32)) >> 0;\n                lo = value >>> 0;\n                bytes.push(0xcf, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n                return 9;\n            }\n            else {\n                // negative fixnum\n                if (value >= -0x20) {\n                    bytes.push(value);\n                    return 1;\n                }\n                // int 8\n                if (value >= -0x80) {\n                    bytes.push(0xd0, value);\n                    return 2;\n                }\n                // int 16\n                if (value >= -0x8000) {\n                    bytes.push(0xd1, value >> 8, value);\n                    return 3;\n                }\n                // int 32\n                if (value >= -0x80000000) {\n                    bytes.push(0xd2, value >> 24, value >> 16, value >> 8, value);\n                    return 5;\n                }\n                // int 64\n                hi = Math.floor(value / Math.pow(2, 32));\n                lo = value >>> 0;\n                bytes.push(0xd3, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n                return 9;\n            }\n        }\n        if (type === 'object') {\n            // nil\n            if (value === null) {\n                bytes.push(0xc0);\n                return 1;\n            }\n            if (Array.isArray(value)) {\n                length = value.length;\n                // fixarray\n                if (length < 0x10) {\n                    bytes.push(length | 0x90);\n                    size = 1;\n                }\n                // array 16\n                else if (length < 0x10000) {\n                    bytes.push(0xdc, length >> 8, length);\n                    size = 3;\n                }\n                // array 32\n                else if (length < 0x100000000) {\n                    bytes.push(0xdd, length >> 24, length >> 16, length >> 8, length);\n                    size = 5;\n                }\n                else {\n                    throw new Error('Array too large');\n                }\n                for (i = 0; i < length; i++) {\n                    size += _encode(bytes, defers, value[i]);\n                }\n                return size;\n            }\n            // fixext 8 / Date\n            if (value instanceof Date) {\n                var time = value.getTime();\n                hi = Math.floor(time / Math.pow(2, 32));\n                lo = time >>> 0;\n                bytes.push(0xd7, 0, hi >> 24, hi >> 16, hi >> 8, hi, lo >> 24, lo >> 16, lo >> 8, lo);\n                return 10;\n            }\n            if (value instanceof ArrayBuffer) {\n                length = value.byteLength;\n                // bin 8\n                if (length < 0x100) {\n                    bytes.push(0xc4, length);\n                    size = 2;\n                }\n                else \n                // bin 16\n                if (length < 0x10000) {\n                    bytes.push(0xc5, length >> 8, length);\n                    size = 3;\n                }\n                else \n                // bin 32\n                if (length < 0x100000000) {\n                    bytes.push(0xc6, length >> 24, length >> 16, length >> 8, length);\n                    size = 5;\n                }\n                else {\n                    throw new Error('Buffer too large');\n                }\n                defers.push({ _bin: value, _length: length, _offset: bytes.length });\n                return size + length;\n            }\n            if (typeof value.toJSON === 'function') {\n                return _encode(bytes, defers, value.toJSON());\n            }\n            var keys = [], key = '';\n            var allKeys = Object.keys(value);\n            for (i = 0, l = allKeys.length; i < l; i++) {\n                key = allKeys[i];\n                if (typeof value[key] !== 'function') {\n                    keys.push(key);\n                }\n            }\n            length = keys.length;\n            // fixmap\n            if (length < 0x10) {\n                bytes.push(length | 0x80);\n                size = 1;\n            }\n            // map 16\n            else if (length < 0x10000) {\n                bytes.push(0xde, length >> 8, length);\n                size = 3;\n            }\n            // map 32\n            else if (length < 0x100000000) {\n                bytes.push(0xdf, length >> 24, length >> 16, length >> 8, length);\n                size = 5;\n            }\n            else {\n                throw new Error('Object too large');\n            }\n            for (i = 0; i < length; i++) {\n                key = keys[i];\n                size += _encode(bytes, defers, key);\n                size += _encode(bytes, defers, value[key]);\n            }\n            return size;\n        }\n        // false/true\n        if (type === 'boolean') {\n            bytes.push(value ? 0xc3 : 0xc2);\n            return 1;\n        }\n        // fixext 1 / undefined\n        if (type === 'undefined') {\n            bytes.push(0xd4, 0, 0);\n            return 3;\n        }\n        throw new Error('Could not encode');\n    }\n    function encode(value) {\n        var bytes = [];\n        var defers = [];\n        var size = _encode(bytes, defers, value);\n        var buf = new ArrayBuffer(size);\n        var view = new DataView(buf);\n        var deferIndex = 0;\n        var deferWritten = 0;\n        var nextOffset = -1;\n        if (defers.length > 0) {\n            nextOffset = defers[0]._offset;\n        }\n        var defer, deferLength = 0, offset = 0;\n        for (var i = 0, l = bytes.length; i < l; i++) {\n            view.setUint8(deferWritten + i, bytes[i]);\n            if (i + 1 !== nextOffset) {\n                continue;\n            }\n            defer = defers[deferIndex];\n            deferLength = defer._length;\n            offset = deferWritten + nextOffset;\n            if (defer._bin) {\n                var bin = new Uint8Array(defer._bin);\n                for (var j = 0; j < deferLength; j++) {\n                    view.setUint8(offset + j, bin[j]);\n                }\n            }\n            else if (defer._str) {\n                utf8Write(view, offset, defer._str);\n            }\n            else if (defer._float !== undefined) {\n                view.setFloat64(offset, defer._float);\n            }\n            deferIndex++;\n            deferWritten += deferLength;\n            if (defers[deferIndex]) {\n                nextOffset = defers[deferIndex]._offset;\n            }\n        }\n        return buf;\n    }\n\n    var browser = function () {\n      throw new Error(\n        'ws does not work in the browser. Browser clients must use the native ' +\n          'WebSocket object'\n      );\n    };\n\n    var WebSocket = globalThis.WebSocket || browser;\n    var WebSocketTransport = /** @class */ (function () {\n        function WebSocketTransport(events) {\n            this.events = events;\n        }\n        WebSocketTransport.prototype.send = function (data) {\n            if (data instanceof ArrayBuffer) {\n                this.ws.send(data);\n            }\n            else if (Array.isArray(data)) {\n                this.ws.send((new Uint8Array(data)).buffer);\n            }\n        };\n        WebSocketTransport.prototype.connect = function (url) {\n            this.ws = new WebSocket(url, this.protocols);\n            this.ws.binaryType = 'arraybuffer';\n            this.ws.onopen = this.events.onopen;\n            this.ws.onmessage = this.events.onmessage;\n            this.ws.onclose = this.events.onclose;\n            this.ws.onerror = this.events.onerror;\n        };\n        WebSocketTransport.prototype.close = function (code, reason) {\n            this.ws.close(code, reason);\n        };\n        return WebSocketTransport;\n    }());\n\n    var Connection = /** @class */ (function () {\n        function Connection() {\n            this.events = {};\n            this.transport = new WebSocketTransport(this.events);\n        }\n        Connection.prototype.send = function (data) {\n            this.transport.send(data);\n        };\n        Connection.prototype.connect = function (url) {\n            this.transport.connect(url);\n        };\n        Connection.prototype.close = function (code, reason) {\n            this.transport.close(code, reason);\n        };\n        return Connection;\n    }());\n\n    var serializers = {};\n    function registerSerializer(id, serializer) {\n        serializers[id] = serializer;\n    }\n    function getSerializer(id) {\n        var serializer = serializers[id];\n        if (!serializer) {\n            throw new Error(\"missing serializer: \" + id);\n        }\n        return serializer;\n    }\n\n    // Use codes between 0~127 for lesser throughput (1 byte)\n    exports.Protocol = void 0;\n    (function (Protocol) {\n        // Room-related (10~19)\n        Protocol[Protocol[\"HANDSHAKE\"] = 9] = \"HANDSHAKE\";\n        Protocol[Protocol[\"JOIN_ROOM\"] = 10] = \"JOIN_ROOM\";\n        Protocol[Protocol[\"ERROR\"] = 11] = \"ERROR\";\n        Protocol[Protocol[\"LEAVE_ROOM\"] = 12] = \"LEAVE_ROOM\";\n        Protocol[Protocol[\"ROOM_DATA\"] = 13] = \"ROOM_DATA\";\n        Protocol[Protocol[\"ROOM_STATE\"] = 14] = \"ROOM_STATE\";\n        Protocol[Protocol[\"ROOM_STATE_PATCH\"] = 15] = \"ROOM_STATE_PATCH\";\n        Protocol[Protocol[\"ROOM_DATA_SCHEMA\"] = 16] = \"ROOM_DATA_SCHEMA\";\n    })(exports.Protocol || (exports.Protocol = {}));\n    exports.ErrorCode = void 0;\n    (function (ErrorCode) {\n        ErrorCode[ErrorCode[\"MATCHMAKE_NO_HANDLER\"] = 4210] = \"MATCHMAKE_NO_HANDLER\";\n        ErrorCode[ErrorCode[\"MATCHMAKE_INVALID_CRITERIA\"] = 4211] = \"MATCHMAKE_INVALID_CRITERIA\";\n        ErrorCode[ErrorCode[\"MATCHMAKE_INVALID_ROOM_ID\"] = 4212] = \"MATCHMAKE_INVALID_ROOM_ID\";\n        ErrorCode[ErrorCode[\"MATCHMAKE_UNHANDLED\"] = 4213] = \"MATCHMAKE_UNHANDLED\";\n        ErrorCode[ErrorCode[\"MATCHMAKE_EXPIRED\"] = 4214] = \"MATCHMAKE_EXPIRED\";\n        ErrorCode[ErrorCode[\"AUTH_FAILED\"] = 4215] = \"AUTH_FAILED\";\n        ErrorCode[ErrorCode[\"APPLICATION_ERROR\"] = 4216] = \"APPLICATION_ERROR\";\n    })(exports.ErrorCode || (exports.ErrorCode = {}));\n    function utf8Read(view, offset) {\n        var length = view[offset++];\n        var string = '', chr = 0;\n        for (var i = offset, end = offset + length; i < end; i++) {\n            var byte = view[i];\n            if ((byte & 0x80) === 0x00) {\n                string += String.fromCharCode(byte);\n                continue;\n            }\n            if ((byte & 0xe0) === 0xc0) {\n                string += String.fromCharCode(((byte & 0x1f) << 6) |\n                    (view[++i] & 0x3f));\n                continue;\n            }\n            if ((byte & 0xf0) === 0xe0) {\n                string += String.fromCharCode(((byte & 0x0f) << 12) |\n                    ((view[++i] & 0x3f) << 6) |\n                    ((view[++i] & 0x3f) << 0));\n                continue;\n            }\n            if ((byte & 0xf8) === 0xf0) {\n                chr = ((byte & 0x07) << 18) |\n                    ((view[++i] & 0x3f) << 12) |\n                    ((view[++i] & 0x3f) << 6) |\n                    ((view[++i] & 0x3f) << 0);\n                if (chr >= 0x010000) { // surrogate pair\n                    chr -= 0x010000;\n                    string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n                }\n                else {\n                    string += String.fromCharCode(chr);\n                }\n                continue;\n            }\n            throw new Error('Invalid byte ' + byte.toString(16));\n        }\n        return string;\n    }\n    // Faster for short strings than Buffer.byteLength\n    function utf8Length(str) {\n        if (str === void 0) { str = ''; }\n        var c = 0;\n        var length = 0;\n        for (var i = 0, l = str.length; i < l; i++) {\n            c = str.charCodeAt(i);\n            if (c < 0x80) {\n                length += 1;\n            }\n            else if (c < 0x800) {\n                length += 2;\n            }\n            else if (c < 0xd800 || c >= 0xe000) {\n                length += 3;\n            }\n            else {\n                i++;\n                length += 4;\n            }\n        }\n        return length + 1;\n    }\n\n    let createNanoEvents = () => ({\n      events: {},\n      emit (event, ...args) {\n    (this.events[event] || []).forEach(i => i(...args));\n      },\n      on (event, cb) {\n    (this.events[event] = this.events[event] || []).push(cb);\n        return () =>\n          (this.events[event] = (this.events[event] || []).filter(i => i !== cb))\n      }\n    });\n\n    var EventEmitter = /** @class */ (function () {\n        function EventEmitter() {\n            this.handlers = [];\n        }\n        EventEmitter.prototype.register = function (cb, once) {\n            this.handlers.push(cb);\n            return this;\n        };\n        EventEmitter.prototype.invoke = function () {\n            var _this = this;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            this.handlers.forEach(function (handler) { return handler.apply(_this, args); });\n        };\n        EventEmitter.prototype.invokeAsync = function () {\n            var _this = this;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return Promise.all(this.handlers.map(function (handler) { return handler.apply(_this, args); }));\n        };\n        EventEmitter.prototype.remove = function (cb) {\n            var index = this.handlers.indexOf(cb);\n            this.handlers[index] = this.handlers[this.handlers.length - 1];\n            this.handlers.pop();\n        };\n        EventEmitter.prototype.clear = function () {\n            this.handlers = [];\n        };\n        return EventEmitter;\n    }());\n    function createSignal() {\n        var emitter = new EventEmitter();\n        function register(cb) {\n            return emitter.register(cb, this === null);\n        }\n        register.once = function (cb) {\n            var callback = function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                cb.apply(this, args);\n                emitter.remove(callback);\n            };\n            emitter.register(callback);\n        };\n        register.remove = function (cb) { return emitter.remove(cb); };\n        register.invoke = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return emitter.invoke.apply(emitter, args);\n        };\n        register.invokeAsync = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return emitter.invokeAsync.apply(emitter, args);\n        };\n        register.clear = function () { return emitter.clear(); };\n        return register;\n    }\n\n    var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n    function createCommonjsModule(fn) {\n      var module = { exports: {} };\n    \treturn fn(module, module.exports), module.exports;\n    }\n\n    var umd = createCommonjsModule(function (module, exports) {\n    (function (global, factory) {\n        factory(exports) ;\n    }(commonjsGlobal, (function (exports) {\n        /*! *****************************************************************************\r\n        Copyright (c) Microsoft Corporation.\r\n\r\n        Permission to use, copy, modify, and/or distribute this software for any\r\n        purpose with or without fee is hereby granted.\r\n\r\n        THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n        PERFORMANCE OF THIS SOFTWARE.\r\n        ***************************************************************************** */\r\n        /* global Reflect, Promise */\r\n\r\n        var extendStatics = function(d, b) {\r\n            extendStatics = Object.setPrototypeOf ||\r\n                ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n                function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n            return extendStatics(d, b);\r\n        };\r\n\r\n        function __extends(d, b) {\r\n            if (typeof b !== \"function\" && b !== null)\r\n                throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n            extendStatics(d, b);\r\n            function __() { this.constructor = d; }\r\n            d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n        }\r\n\r\n        function __decorate(decorators, target, key, desc) {\r\n            var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n            if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n            else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n            return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n        }\r\n\r\n        function __spreadArray(to, from) {\r\n            for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n                to[j] = from[i];\r\n            return to;\r\n        }\n\n        // export const SWITCH_TO_STRUCTURE = 193; (easily collides with DELETE_AND_ADD + fieldIndex = 2)\n        var SWITCH_TO_STRUCTURE = 255; // (decoding collides with DELETE_AND_ADD + fieldIndex = 63)\n        var TYPE_ID = 213;\n        /**\n         * Encoding Schema field operations.\n         */\n        exports.OPERATION = void 0;\n        (function (OPERATION) {\n            // add new structure/primitive\n            OPERATION[OPERATION[\"ADD\"] = 128] = \"ADD\";\n            // replace structure/primitive\n            OPERATION[OPERATION[\"REPLACE\"] = 0] = \"REPLACE\";\n            // delete field\n            OPERATION[OPERATION[\"DELETE\"] = 64] = \"DELETE\";\n            // DELETE field, followed by an ADD\n            OPERATION[OPERATION[\"DELETE_AND_ADD\"] = 192] = \"DELETE_AND_ADD\";\n            // TOUCH is used to determine hierarchy of nested Schema structures during serialization.\n            // touches are NOT encoded.\n            OPERATION[OPERATION[\"TOUCH\"] = 1] = \"TOUCH\";\n            // MapSchema Operations\n            OPERATION[OPERATION[\"CLEAR\"] = 10] = \"CLEAR\";\n        })(exports.OPERATION || (exports.OPERATION = {}));\n        // export enum OPERATION {\n        //     // add new structure/primitive\n        //     // (128)\n        //     ADD = 128, // 10000000,\n        //     // replace structure/primitive\n        //     REPLACE = 1,// 00000001\n        //     // delete field\n        //     DELETE = 192, // 11000000\n        //     // DELETE field, followed by an ADD\n        //     DELETE_AND_ADD = 224, // 11100000\n        //     // TOUCH is used to determine hierarchy of nested Schema structures during serialization.\n        //     // touches are NOT encoded.\n        //     TOUCH = 0, // 00000000\n        //     // MapSchema Operations\n        //     CLEAR = 10,\n        // }\n\n        //\n        // Root holds all schema references by unique id\n        //\n        var Root = /** @class */ (function () {\n            function Root() {\n                //\n                // Relation of refId => Schema structure\n                // For direct access of structures during decoding time.\n                //\n                this.refs = new Map();\n                this.refCounts = {};\n                this.deletedRefs = new Set();\n                this.nextUniqueId = 0;\n            }\n            Root.prototype.getNextUniqueId = function () {\n                return this.nextUniqueId++;\n            };\n            // for decoding\n            Root.prototype.addRef = function (refId, ref, incrementCount) {\n                if (incrementCount === void 0) { incrementCount = true; }\n                this.refs.set(refId, ref);\n                if (incrementCount) {\n                    this.refCounts[refId] = (this.refCounts[refId] || 0) + 1;\n                }\n            };\n            // for decoding\n            Root.prototype.removeRef = function (refId) {\n                this.refCounts[refId] = this.refCounts[refId] - 1;\n                this.deletedRefs.add(refId);\n            };\n            Root.prototype.clearRefs = function () {\n                this.refs.clear();\n                this.deletedRefs.clear();\n                this.refCounts = {};\n            };\n            // for decoding\n            Root.prototype.garbageCollectDeletedRefs = function () {\n                var _this = this;\n                this.deletedRefs.forEach(function (refId) {\n                    if (_this.refCounts[refId] <= 0) {\n                        var ref = _this.refs.get(refId);\n                        //\n                        // Ensure child schema instances have their references removed as well.\n                        //\n                        if (ref instanceof Schema) {\n                            for (var fieldName in ref['_definition'].schema) {\n                                if (typeof (ref['_definition'].schema[fieldName]) !== \"string\" &&\n                                    ref[fieldName] &&\n                                    ref[fieldName]['$changes']) {\n                                    _this.removeRef(ref[fieldName]['$changes'].refId);\n                                }\n                            }\n                        }\n                        else {\n                            var definition = ref['$changes'].parent._definition;\n                            var type = definition.schema[definition.fieldsByIndex[ref['$changes'].parentIndex]];\n                            if (typeof (Object.values(type)[0]) === \"function\") {\n                                Array.from(ref.values())\n                                    .forEach(function (child) { return _this.removeRef(child['$changes'].refId); });\n                            }\n                        }\n                        _this.refs.delete(refId);\n                        delete _this.refCounts[refId];\n                    }\n                });\n                // clear deleted refs.\n                this.deletedRefs.clear();\n            };\n            return Root;\n        }());\n        var ChangeTree = /** @class */ (function () {\n            function ChangeTree(ref, parent, root) {\n                this.changed = false;\n                this.changes = new Map();\n                this.allChanges = new Set();\n                // cached indexes for filtering\n                this.caches = {};\n                this.currentCustomOperation = 0;\n                this.ref = ref;\n                this.setParent(parent, root);\n            }\n            ChangeTree.prototype.setParent = function (parent, root, parentIndex) {\n                var _this = this;\n                if (!this.indexes) {\n                    this.indexes = (this.ref instanceof Schema)\n                        ? this.ref['_definition'].indexes\n                        : {};\n                }\n                this.parent = parent;\n                this.parentIndex = parentIndex;\n                // avoid setting parents with empty `root`\n                if (!root) {\n                    return;\n                }\n                this.root = root;\n                //\n                // assign same parent on child structures\n                //\n                if (this.ref instanceof Schema) {\n                    var definition = this.ref['_definition'];\n                    for (var field in definition.schema) {\n                        var value = this.ref[field];\n                        if (value && value['$changes']) {\n                            var parentIndex_1 = definition.indexes[field];\n                            value['$changes'].setParent(this.ref, root, parentIndex_1);\n                        }\n                    }\n                }\n                else if (typeof (this.ref) === \"object\") {\n                    this.ref.forEach(function (value, key) {\n                        if (value instanceof Schema) {\n                            var changeTreee = value['$changes'];\n                            var parentIndex_2 = _this.ref['$changes'].indexes[key];\n                            changeTreee.setParent(_this.ref, _this.root, parentIndex_2);\n                        }\n                    });\n                }\n            };\n            ChangeTree.prototype.operation = function (op) {\n                this.changes.set(--this.currentCustomOperation, op);\n            };\n            ChangeTree.prototype.change = function (fieldName, operation) {\n                if (operation === void 0) { operation = exports.OPERATION.ADD; }\n                var index = (typeof (fieldName) === \"number\")\n                    ? fieldName\n                    : this.indexes[fieldName];\n                this.assertValidIndex(index, fieldName);\n                var previousChange = this.changes.get(index);\n                if (!previousChange ||\n                    previousChange.op === exports.OPERATION.DELETE ||\n                    previousChange.op === exports.OPERATION.TOUCH // (mazmorra.io's BattleAction issue)\n                ) {\n                    this.changes.set(index, {\n                        op: (!previousChange)\n                            ? operation\n                            : (previousChange.op === exports.OPERATION.DELETE)\n                                ? exports.OPERATION.DELETE_AND_ADD\n                                : operation,\n                        // : OPERATION.REPLACE,\n                        index: index\n                    });\n                }\n                this.allChanges.add(index);\n                this.changed = true;\n                this.touchParents();\n            };\n            ChangeTree.prototype.touch = function (fieldName) {\n                var index = (typeof (fieldName) === \"number\")\n                    ? fieldName\n                    : this.indexes[fieldName];\n                this.assertValidIndex(index, fieldName);\n                if (!this.changes.has(index)) {\n                    this.changes.set(index, { op: exports.OPERATION.TOUCH, index: index });\n                }\n                this.allChanges.add(index);\n                // ensure touch is placed until the $root is found.\n                this.touchParents();\n            };\n            ChangeTree.prototype.touchParents = function () {\n                if (this.parent) {\n                    this.parent['$changes'].touch(this.parentIndex);\n                }\n            };\n            ChangeTree.prototype.getType = function (index) {\n                if (this.ref['_definition']) {\n                    var definition = this.ref['_definition'];\n                    return definition.schema[definition.fieldsByIndex[index]];\n                }\n                else {\n                    var definition = this.parent['_definition'];\n                    var parentType = definition.schema[definition.fieldsByIndex[this.parentIndex]];\n                    //\n                    // Get the child type from parent structure.\n                    // - [\"string\"] => \"string\"\n                    // - { map: \"string\" } => \"string\"\n                    // - { set: \"string\" } => \"string\"\n                    //\n                    return Object.values(parentType)[0];\n                }\n            };\n            ChangeTree.prototype.getChildrenFilter = function () {\n                var childFilters = this.parent['_definition'].childFilters;\n                return childFilters && childFilters[this.parentIndex];\n            };\n            //\n            // used during `.encode()`\n            //\n            ChangeTree.prototype.getValue = function (index) {\n                return this.ref['getByIndex'](index);\n            };\n            ChangeTree.prototype.delete = function (fieldName) {\n                var index = (typeof (fieldName) === \"number\")\n                    ? fieldName\n                    : this.indexes[fieldName];\n                if (index === undefined) {\n                    console.warn(\"@colyseus/schema \" + this.ref.constructor.name + \": trying to delete non-existing index: \" + fieldName + \" (\" + index + \")\");\n                    return;\n                }\n                var previousValue = this.getValue(index);\n                // console.log(\"$changes.delete =>\", { fieldName, index, previousValue });\n                this.changes.set(index, { op: exports.OPERATION.DELETE, index: index });\n                this.allChanges.delete(index);\n                // delete cache\n                delete this.caches[index];\n                // remove `root` reference\n                if (previousValue && previousValue['$changes']) {\n                    previousValue['$changes'].parent = undefined;\n                }\n                this.changed = true;\n                this.touchParents();\n            };\n            ChangeTree.prototype.discard = function (changed, discardAll) {\n                var _this = this;\n                if (changed === void 0) { changed = false; }\n                if (discardAll === void 0) { discardAll = false; }\n                //\n                // Map, Array, etc:\n                // Remove cached key to ensure ADD operations is unsed instead of\n                // REPLACE in case same key is used on next patches.\n                //\n                // TODO: refactor this. this is not relevant for Collection and Set.\n                //\n                if (!(this.ref instanceof Schema)) {\n                    this.changes.forEach(function (change) {\n                        if (change.op === exports.OPERATION.DELETE) {\n                            var index = _this.ref['getIndex'](change.index);\n                            delete _this.indexes[index];\n                        }\n                    });\n                }\n                this.changes.clear();\n                this.changed = changed;\n                if (discardAll) {\n                    this.allChanges.clear();\n                }\n                // re-set `currentCustomOperation`\n                this.currentCustomOperation = 0;\n            };\n            /**\n             * Recursively discard all changes from this, and child structures.\n             */\n            ChangeTree.prototype.discardAll = function () {\n                var _this = this;\n                this.changes.forEach(function (change) {\n                    var value = _this.getValue(change.index);\n                    if (value && value['$changes']) {\n                        value['$changes'].discardAll();\n                    }\n                });\n                this.discard();\n            };\n            // cache(field: number, beginIndex: number, endIndex: number) {\n            ChangeTree.prototype.cache = function (field, cachedBytes) {\n                this.caches[field] = cachedBytes;\n            };\n            ChangeTree.prototype.clone = function () {\n                return new ChangeTree(this.ref, this.parent, this.root);\n            };\n            ChangeTree.prototype.ensureRefId = function () {\n                // skip if refId is already set.\n                if (this.refId !== undefined) {\n                    return;\n                }\n                this.refId = this.root.getNextUniqueId();\n            };\n            ChangeTree.prototype.assertValidIndex = function (index, fieldName) {\n                if (index === undefined) {\n                    throw new Error(\"ChangeTree: missing index for field \\\"\" + fieldName + \"\\\"\");\n                }\n            };\n            return ChangeTree;\n        }());\n\n        //\n        // Notes:\n        // -----\n        //\n        // - The tsconfig.json of @colyseus/schema uses ES2018.\n        // - ES2019 introduces `flatMap` / `flat`, which is not currently relevant, and caused other issues.\n        //\n        var DEFAULT_SORT = function (a, b) {\n            var A = a.toString();\n            var B = b.toString();\n            if (A < B)\n                return -1;\n            else if (A > B)\n                return 1;\n            else\n                return 0;\n        };\n        function getArrayProxy(value) {\n            value['$proxy'] = true;\n            //\n            // compatibility with @colyseus/schema 0.5.x\n            // - allow `map[\"key\"]`\n            // - allow `map[\"key\"] = \"xxx\"`\n            // - allow `delete map[\"key\"]`\n            //\n            value = new Proxy(value, {\n                get: function (obj, prop) {\n                    if (typeof (prop) !== \"symbol\" &&\n                        !isNaN(prop) // https://stackoverflow.com/a/175787/892698\n                    ) {\n                        return obj.at(prop);\n                    }\n                    else {\n                        return obj[prop];\n                    }\n                },\n                set: function (obj, prop, setValue) {\n                    if (typeof (prop) !== \"symbol\" &&\n                        !isNaN(prop)) {\n                        var indexes = Array.from(obj['$items'].keys());\n                        var key = parseInt(indexes[prop] || prop);\n                        if (setValue === undefined || setValue === null) {\n                            obj.deleteAt(key);\n                        }\n                        else {\n                            obj.setAt(key, setValue);\n                        }\n                    }\n                    else {\n                        obj[prop] = setValue;\n                    }\n                    return true;\n                },\n                deleteProperty: function (obj, prop) {\n                    if (typeof (prop) === \"number\") {\n                        obj.deleteAt(prop);\n                    }\n                    else {\n                        delete obj[prop];\n                    }\n                    return true;\n                },\n            });\n            return value;\n        }\n        var ArraySchema = /** @class */ (function () {\n            function ArraySchema() {\n                var items = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    items[_i] = arguments[_i];\n                }\n                this.$changes = new ChangeTree(this);\n                this.$items = new Map();\n                this.$indexes = new Map();\n                this.$refId = 0;\n                this.push.apply(this, items);\n            }\n            ArraySchema.is = function (type) {\n                return Array.isArray(type);\n            };\n            Object.defineProperty(ArraySchema.prototype, \"length\", {\n                get: function () {\n                    return this.$items.size;\n                },\n                set: function (value) {\n                    if (value === 0) {\n                        this.clear();\n                    }\n                    else {\n                        this.splice(value, this.length - value);\n                    }\n                },\n                enumerable: false,\n                configurable: true\n            });\n            ArraySchema.prototype.push = function () {\n                var _this = this;\n                var values = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    values[_i] = arguments[_i];\n                }\n                var lastIndex;\n                values.forEach(function (value) {\n                    // set \"index\" for reference.\n                    lastIndex = _this.$refId++;\n                    _this.setAt(lastIndex, value);\n                });\n                return lastIndex;\n            };\n            /**\n             * Removes the last element from an array and returns it.\n             */\n            ArraySchema.prototype.pop = function () {\n                var key = Array.from(this.$indexes.values()).pop();\n                if (key === undefined) {\n                    return undefined;\n                }\n                this.$changes.delete(key);\n                this.$indexes.delete(key);\n                var value = this.$items.get(key);\n                this.$items.delete(key);\n                return value;\n            };\n            ArraySchema.prototype.at = function (index) {\n                //\n                // FIXME: this should be O(1)\n                //\n                var key = Array.from(this.$items.keys())[index];\n                return this.$items.get(key);\n            };\n            ArraySchema.prototype.setAt = function (index, value) {\n                var _a, _b;\n                if (value['$changes'] !== undefined) {\n                    value['$changes'].setParent(this, this.$changes.root, index);\n                }\n                var operation = (_b = (_a = this.$changes.indexes[index]) === null || _a === void 0 ? void 0 : _a.op) !== null && _b !== void 0 ? _b : exports.OPERATION.ADD;\n                this.$changes.indexes[index] = index;\n                this.$indexes.set(index, index);\n                this.$items.set(index, value);\n                this.$changes.change(index, operation);\n            };\n            ArraySchema.prototype.deleteAt = function (index) {\n                var key = Array.from(this.$items.keys())[index];\n                if (key === undefined) {\n                    return false;\n                }\n                return this.$deleteAt(key);\n            };\n            ArraySchema.prototype.$deleteAt = function (index) {\n                // delete at internal index\n                this.$changes.delete(index);\n                this.$indexes.delete(index);\n                return this.$items.delete(index);\n            };\n            ArraySchema.prototype.clear = function (isDecoding) {\n                var _this = this;\n                // discard previous operations.\n                this.$changes.discard(true, true);\n                this.$changes.indexes = {};\n                // clear previous indexes\n                this.$indexes.clear();\n                // flag child items for garbage collection.\n                if (isDecoding && typeof (this.$changes.getType()) !== \"string\") {\n                    this.$items.forEach(function (item) {\n                        _this.$changes.root.removeRef(item['$changes'].refId);\n                    });\n                }\n                // clear items\n                this.$items.clear();\n                this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                // touch all structures until reach root\n                this.$changes.touchParents();\n            };\n            /**\n             * Combines two or more arrays.\n             * @param items Additional items to add to the end of array1.\n             */\n            ArraySchema.prototype.concat = function () {\n                var _a;\n                var items = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    items[_i] = arguments[_i];\n                }\n                return new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], (_a = Array.from(this.$items.values())).concat.apply(_a, items))))();\n            };\n            /**\n             * Adds all the elements of an array separated by the specified separator string.\n             * @param separator A string used to separate one element of an array from the next in the resulting String. If omitted, the array elements are separated with a comma.\n             */\n            ArraySchema.prototype.join = function (separator) {\n                return Array.from(this.$items.values()).join(separator);\n            };\n            /**\n             * Reverses the elements in an Array.\n             */\n            ArraySchema.prototype.reverse = function () {\n                var _this = this;\n                var indexes = Array.from(this.$items.keys());\n                var reversedItems = Array.from(this.$items.values()).reverse();\n                reversedItems.forEach(function (item, i) {\n                    _this.setAt(indexes[i], item);\n                });\n                return this;\n            };\n            /**\n             * Removes the first element from an array and returns it.\n             */\n            ArraySchema.prototype.shift = function () {\n                var indexes = Array.from(this.$items.keys());\n                var shiftAt = indexes.shift();\n                if (shiftAt === undefined) {\n                    return undefined;\n                }\n                var value = this.$items.get(shiftAt);\n                this.$deleteAt(shiftAt);\n                return value;\n            };\n            /**\n             * Returns a section of an array.\n             * @param start The beginning of the specified portion of the array.\n             * @param end The end of the specified portion of the array. This is exclusive of the element at the index 'end'.\n             */\n            ArraySchema.prototype.slice = function (start, end) {\n                return new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], Array.from(this.$items.values()).slice(start, end))))();\n            };\n            /**\n             * Sorts an array.\n             * @param compareFn Function used to determine the order of the elements. It is expected to return\n             * a negative value if first argument is less than second argument, zero if they're equal and a positive\n             * value otherwise. If omitted, the elements are sorted in ascending, ASCII character order.\n             * ```ts\n             * [11,2,22,1].sort((a, b) => a - b)\n             * ```\n             */\n            ArraySchema.prototype.sort = function (compareFn) {\n                var _this = this;\n                if (compareFn === void 0) { compareFn = DEFAULT_SORT; }\n                var indexes = Array.from(this.$items.keys());\n                var sortedItems = Array.from(this.$items.values()).sort(compareFn);\n                sortedItems.forEach(function (item, i) {\n                    _this.setAt(indexes[i], item);\n                });\n                return this;\n            };\n            /**\n             * Removes elements from an array and, if necessary, inserts new elements in their place, returning the deleted elements.\n             * @param start The zero-based location in the array from which to start removing elements.\n             * @param deleteCount The number of elements to remove.\n             * @param items Elements to insert into the array in place of the deleted elements.\n             */\n            ArraySchema.prototype.splice = function (start, deleteCount) {\n                if (deleteCount === void 0) { deleteCount = this.length - start; }\n                var items = [];\n                for (var _i = 2; _i < arguments.length; _i++) {\n                    items[_i - 2] = arguments[_i];\n                }\n                var indexes = Array.from(this.$items.keys());\n                var removedItems = [];\n                for (var i = start; i < start + deleteCount; i++) {\n                    removedItems.push(this.$items.get(indexes[i]));\n                    this.$deleteAt(indexes[i]);\n                }\n                return removedItems;\n            };\n            /**\n             * Inserts new elements at the start of an array.\n             * @param items  Elements to insert at the start of the Array.\n             */\n            ArraySchema.prototype.unshift = function () {\n                var _this = this;\n                var items = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    items[_i] = arguments[_i];\n                }\n                var length = this.length;\n                var addedLength = items.length;\n                // const indexes = Array.from(this.$items.keys());\n                var previousValues = Array.from(this.$items.values());\n                items.forEach(function (item, i) {\n                    _this.setAt(i, item);\n                });\n                previousValues.forEach(function (previousValue, i) {\n                    _this.setAt(addedLength + i, previousValue);\n                });\n                return length + addedLength;\n            };\n            /**\n             * Returns the index of the first occurrence of a value in an array.\n             * @param searchElement The value to locate in the array.\n             * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at index 0.\n             */\n            ArraySchema.prototype.indexOf = function (searchElement, fromIndex) {\n                return Array.from(this.$items.values()).indexOf(searchElement, fromIndex);\n            };\n            /**\n             * Returns the index of the last occurrence of a specified value in an array.\n             * @param searchElement The value to locate in the array.\n             * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at the last index in the array.\n             */\n            ArraySchema.prototype.lastIndexOf = function (searchElement, fromIndex) {\n                if (fromIndex === void 0) { fromIndex = this.length - 1; }\n                return Array.from(this.$items.values()).lastIndexOf(searchElement, fromIndex);\n            };\n            /**\n             * Determines whether all the members of an array satisfy the specified test.\n             * @param callbackfn A function that accepts up to three arguments. The every method calls\n             * the callbackfn function for each element in the array until the callbackfn returns a value\n             * which is coercible to the Boolean value false, or until the end of the array.\n             * @param thisArg An object to which the this keyword can refer in the callbackfn function.\n             * If thisArg is omitted, undefined is used as the this value.\n             */\n            ArraySchema.prototype.every = function (callbackfn, thisArg) {\n                return Array.from(this.$items.values()).every(callbackfn, thisArg);\n            };\n            /**\n             * Determines whether the specified callback function returns true for any element of an array.\n             * @param callbackfn A function that accepts up to three arguments. The some method calls\n             * the callbackfn function for each element in the array until the callbackfn returns a value\n             * which is coercible to the Boolean value true, or until the end of the array.\n             * @param thisArg An object to which the this keyword can refer in the callbackfn function.\n             * If thisArg is omitted, undefined is used as the this value.\n             */\n            ArraySchema.prototype.some = function (callbackfn, thisArg) {\n                return Array.from(this.$items.values()).some(callbackfn, thisArg);\n            };\n            /**\n             * Performs the specified action for each element in an array.\n             * @param callbackfn  A function that accepts up to three arguments. forEach calls the callbackfn function one time for each element in the array.\n             * @param thisArg  An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\n             */\n            ArraySchema.prototype.forEach = function (callbackfn, thisArg) {\n                Array.from(this.$items.values()).forEach(callbackfn, thisArg);\n            };\n            /**\n             * Calls a defined callback function on each element of an array, and returns an array that contains the results.\n             * @param callbackfn A function that accepts up to three arguments. The map method calls the callbackfn function one time for each element in the array.\n             * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\n             */\n            ArraySchema.prototype.map = function (callbackfn, thisArg) {\n                return Array.from(this.$items.values()).map(callbackfn, thisArg);\n            };\n            ArraySchema.prototype.filter = function (callbackfn, thisArg) {\n                return Array.from(this.$items.values()).filter(callbackfn, thisArg);\n            };\n            /**\n             * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\n             * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\n             * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\n             */\n            ArraySchema.prototype.reduce = function (callbackfn, initialValue) {\n                return Array.from(this.$items.values()).reduce(callbackfn, initialValue);\n            };\n            /**\n             * Calls the specified callback function for all the elements in an array, in descending order. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.\n             * @param callbackfn A function that accepts up to four arguments. The reduceRight method calls the callbackfn function one time for each element in the array.\n             * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\n             */\n            ArraySchema.prototype.reduceRight = function (callbackfn, initialValue) {\n                return Array.from(this.$items.values()).reduceRight(callbackfn, initialValue);\n            };\n            /**\n             * Returns the value of the first element in the array where predicate is true, and undefined\n             * otherwise.\n             * @param predicate find calls predicate once for each element of the array, in ascending\n             * order, until it finds one where predicate returns true. If such an element is found, find\n             * immediately returns that element value. Otherwise, find returns undefined.\n             * @param thisArg If provided, it will be used as the this value for each invocation of\n             * predicate. If it is not provided, undefined is used instead.\n             */\n            ArraySchema.prototype.find = function (predicate, thisArg) {\n                return Array.from(this.$items.values()).find(predicate, thisArg);\n            };\n            /**\n             * Returns the index of the first element in the array where predicate is true, and -1\n             * otherwise.\n             * @param predicate find calls predicate once for each element of the array, in ascending\n             * order, until it finds one where predicate returns true. If such an element is found,\n             * findIndex immediately returns that element index. Otherwise, findIndex returns -1.\n             * @param thisArg If provided, it will be used as the this value for each invocation of\n             * predicate. If it is not provided, undefined is used instead.\n             */\n            ArraySchema.prototype.findIndex = function (predicate, thisArg) {\n                return Array.from(this.$items.values()).findIndex(predicate, thisArg);\n            };\n            /**\n             * Returns the this object after filling the section identified by start and end with value\n             * @param value value to fill array section with\n             * @param start index to start filling the array at. If start is negative, it is treated as\n             * length+start where length is the length of the array.\n             * @param end index to stop filling the array at. If end is negative, it is treated as\n             * length+end.\n             */\n            ArraySchema.prototype.fill = function (value, start, end) {\n                //\n                // TODO\n                //\n                throw new Error(\"ArraySchema#fill() not implemented\");\n            };\n            /**\n             * Returns the this object after copying a section of the array identified by start and end\n             * to the same array starting at position target\n             * @param target If target is negative, it is treated as length+target where length is the\n             * length of the array.\n             * @param start If start is negative, it is treated as length+start. If end is negative, it\n             * is treated as length+end.\n             * @param end If not specified, length of the this object is used as its default value.\n             */\n            ArraySchema.prototype.copyWithin = function (target, start, end) {\n                //\n                // TODO\n                //\n                throw new Error(\"ArraySchema#copyWithin() not implemented\");\n            };\n            /**\n             * Returns a string representation of an array.\n             */\n            ArraySchema.prototype.toString = function () { return this.$items.toString(); };\n            /**\n             * Returns a string representation of an array. The elements are converted to string using their toLocalString methods.\n             */\n            ArraySchema.prototype.toLocaleString = function () { return this.$items.toLocaleString(); };\n            /** Iterator */\n            ArraySchema.prototype[Symbol.iterator] = function () {\n                return Array.from(this.$items.values())[Symbol.iterator]();\n            };\n            ArraySchema.prototype[Symbol.unscopables] = function () {\n                return this.$items[Symbol.unscopables]();\n            };\n            /**\n             * Returns an iterable of key, value pairs for every entry in the array\n             */\n            ArraySchema.prototype.entries = function () { return this.$items.entries(); };\n            /**\n             * Returns an iterable of keys in the array\n             */\n            ArraySchema.prototype.keys = function () { return this.$items.keys(); };\n            /**\n             * Returns an iterable of values in the array\n             */\n            ArraySchema.prototype.values = function () { return this.$items.values(); };\n            /**\n             * Determines whether an array includes a certain element, returning true or false as appropriate.\n             * @param searchElement The element to search for.\n             * @param fromIndex The position in this array at which to begin searching for searchElement.\n             */\n            ArraySchema.prototype.includes = function (searchElement, fromIndex) {\n                return Array.from(this.$items.values()).includes(searchElement, fromIndex);\n            };\n            /**\n             * Calls a defined callback function on each element of an array. Then, flattens the result into\n             * a new array.\n             * This is identical to a map followed by flat with depth 1.\n             *\n             * @param callback A function that accepts up to three arguments. The flatMap method calls the\n             * callback function one time for each element in the array.\n             * @param thisArg An object to which the this keyword can refer in the callback function. If\n             * thisArg is omitted, undefined is used as the this value.\n             */\n            // @ts-ignore\n            ArraySchema.prototype.flatMap = function (callback, thisArg) {\n                // @ts-ignore\n                throw new Error(\"ArraySchema#flatMap() is not supported.\");\n            };\n            /**\n             * Returns a new array with all sub-array elements concatenated into it recursively up to the\n             * specified depth.\n             *\n             * @param depth The maximum recursion depth\n             */\n            // @ts-ignore\n            ArraySchema.prototype.flat = function (depth) {\n                // @ts-ignore\n                throw new Error(\"ArraySchema#flat() is not supported.\");\n            };\n            // get size () {\n            //     return this.$items.size;\n            // }\n            ArraySchema.prototype.setIndex = function (index, key) {\n                this.$indexes.set(index, key);\n            };\n            ArraySchema.prototype.getIndex = function (index) {\n                return this.$indexes.get(index);\n            };\n            ArraySchema.prototype.getByIndex = function (index) {\n                return this.$items.get(this.$indexes.get(index));\n            };\n            ArraySchema.prototype.deleteByIndex = function (index) {\n                var key = this.$indexes.get(index);\n                this.$items.delete(key);\n                this.$indexes.delete(index);\n            };\n            ArraySchema.prototype.toArray = function () {\n                return Array.from(this.$items.values());\n            };\n            ArraySchema.prototype.toJSON = function () {\n                return this.toArray().map(function (value) {\n                    return (typeof (value['toJSON']) === \"function\")\n                        ? value['toJSON']()\n                        : value;\n                });\n            };\n            //\n            // Decoding utilities\n            //\n            ArraySchema.prototype.clone = function (isDecoding) {\n                var cloned;\n                if (isDecoding) {\n                    cloned = new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], Array.from(this.$items.values()))))();\n                }\n                else {\n                    cloned = new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], this.map(function (item) { return ((item['$changes'])\n                        ? item.clone()\n                        : item); }))))();\n                }\n                return cloned;\n            };\n            ArraySchema.prototype.triggerAll = function () {\n                Schema.prototype.triggerAll.apply(this);\n            };\n            return ArraySchema;\n        }());\n\n        function getMapProxy(value) {\n            value['$proxy'] = true;\n            value = new Proxy(value, {\n                get: function (obj, prop) {\n                    if (typeof (prop) !== \"symbol\" && // accessing properties\n                        typeof (obj[prop]) === \"undefined\") {\n                        return obj.get(prop);\n                    }\n                    else {\n                        return obj[prop];\n                    }\n                },\n                set: function (obj, prop, setValue) {\n                    if (typeof (prop) !== \"symbol\" &&\n                        (prop.indexOf(\"$\") === -1 &&\n                            prop !== \"onAdd\" &&\n                            prop !== \"onRemove\" &&\n                            prop !== \"onChange\")) {\n                        obj.set(prop, setValue);\n                    }\n                    else {\n                        obj[prop] = setValue;\n                    }\n                    return true;\n                },\n                deleteProperty: function (obj, prop) {\n                    obj.delete(prop);\n                    return true;\n                },\n            });\n            return value;\n        }\n        var MapSchema = /** @class */ (function () {\n            function MapSchema(initialValues) {\n                var _this = this;\n                this.$changes = new ChangeTree(this);\n                this.$items = new Map();\n                this.$indexes = new Map();\n                this.$refId = 0;\n                if (initialValues) {\n                    if (initialValues instanceof Map) {\n                        initialValues.forEach(function (v, k) { return _this.set(k, v); });\n                    }\n                    else {\n                        for (var k in initialValues) {\n                            this.set(k, initialValues[k]);\n                        }\n                    }\n                }\n            }\n            MapSchema.is = function (type) {\n                return type['map'] !== undefined;\n            };\n            /** Iterator */\n            MapSchema.prototype[Symbol.iterator] = function () { return this.$items[Symbol.iterator](); };\n            Object.defineProperty(MapSchema.prototype, Symbol.toStringTag, {\n                get: function () { return this.$items[Symbol.toStringTag]; },\n                enumerable: false,\n                configurable: true\n            });\n            MapSchema.prototype.set = function (key, value) {\n                // get \"index\" for this value.\n                var hasIndex = typeof (this.$changes.indexes[key]) !== \"undefined\";\n                var index = (hasIndex)\n                    ? this.$changes.indexes[key]\n                    : this.$refId++;\n                var operation = (hasIndex)\n                    ? exports.OPERATION.REPLACE\n                    : exports.OPERATION.ADD;\n                var isRef = (value['$changes']) !== undefined;\n                if (isRef) {\n                    value['$changes'].setParent(this, this.$changes.root, index);\n                }\n                //\n                // (encoding)\n                // set a unique id to relate directly with this key/value.\n                //\n                if (!hasIndex) {\n                    this.$changes.indexes[key] = index;\n                    this.$indexes.set(index, key);\n                }\n                else if (isRef && // if is schema, force ADD operation if value differ from previous one.\n                    this.$items.get(key) !== value) {\n                    operation = exports.OPERATION.ADD;\n                }\n                this.$items.set(key, value);\n                this.$changes.change(key, operation);\n                return this;\n            };\n            MapSchema.prototype.get = function (key) {\n                return this.$items.get(key);\n            };\n            MapSchema.prototype.delete = function (key) {\n                //\n                // TODO: add a \"purge\" method after .encode() runs, to cleanup removed `$indexes`\n                //\n                // We don't remove $indexes to allow setting the same key in the same patch\n                // (See \"should allow to remove and set an item in the same place\" test)\n                //\n                // // const index = this.$changes.indexes[key];\n                // // this.$indexes.delete(index);\n                this.$changes.delete(key);\n                return this.$items.delete(key);\n            };\n            MapSchema.prototype.clear = function (isDecoding) {\n                var _this = this;\n                // discard previous operations.\n                this.$changes.discard(true, true);\n                this.$changes.indexes = {};\n                // clear previous indexes\n                this.$indexes.clear();\n                // flag child items for garbage collection.\n                if (isDecoding && typeof (this.$changes.getType()) !== \"string\") {\n                    this.$items.forEach(function (item) {\n                        _this.$changes.root.removeRef(item['$changes'].refId);\n                    });\n                }\n                // clear items\n                this.$items.clear();\n                this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                // touch all structures until reach root\n                this.$changes.touchParents();\n            };\n            MapSchema.prototype.has = function (key) {\n                return this.$items.has(key);\n            };\n            MapSchema.prototype.forEach = function (callbackfn) {\n                this.$items.forEach(callbackfn);\n            };\n            MapSchema.prototype.entries = function () {\n                return this.$items.entries();\n            };\n            MapSchema.prototype.keys = function () {\n                return this.$items.keys();\n            };\n            MapSchema.prototype.values = function () {\n                return this.$items.values();\n            };\n            Object.defineProperty(MapSchema.prototype, \"size\", {\n                get: function () {\n                    return this.$items.size;\n                },\n                enumerable: false,\n                configurable: true\n            });\n            MapSchema.prototype.setIndex = function (index, key) {\n                this.$indexes.set(index, key);\n            };\n            MapSchema.prototype.getIndex = function (index) {\n                return this.$indexes.get(index);\n            };\n            MapSchema.prototype.getByIndex = function (index) {\n                return this.$items.get(this.$indexes.get(index));\n            };\n            MapSchema.prototype.deleteByIndex = function (index) {\n                var key = this.$indexes.get(index);\n                this.$items.delete(key);\n                this.$indexes.delete(index);\n            };\n            MapSchema.prototype.toJSON = function () {\n                var map = {};\n                this.forEach(function (value, key) {\n                    map[key] = (typeof (value['toJSON']) === \"function\")\n                        ? value['toJSON']()\n                        : value;\n                });\n                return map;\n            };\n            //\n            // Decoding utilities\n            //\n            MapSchema.prototype.clone = function (isDecoding) {\n                var cloned;\n                if (isDecoding) {\n                    // client-side\n                    cloned = Object.assign(new MapSchema(), this);\n                }\n                else {\n                    // server-side\n                    cloned = new MapSchema();\n                    this.forEach(function (value, key) {\n                        if (value['$changes']) {\n                            cloned.set(key, value['clone']());\n                        }\n                        else {\n                            cloned.set(key, value);\n                        }\n                    });\n                }\n                return cloned;\n            };\n            MapSchema.prototype.triggerAll = function () {\n                Schema.prototype.triggerAll.apply(this);\n            };\n            return MapSchema;\n        }());\n\n        var registeredTypes = {};\n        function registerType(identifier, definition) {\n            registeredTypes[identifier] = definition;\n        }\n        function getType(identifier) {\n            return registeredTypes[identifier];\n        }\n\n        var SchemaDefinition = /** @class */ (function () {\n            function SchemaDefinition() {\n                //\n                // TODO: use a \"field\" structure combining all these properties per-field.\n                //\n                this.indexes = {};\n                this.fieldsByIndex = {};\n                this.deprecated = {};\n                this.descriptors = {};\n            }\n            SchemaDefinition.create = function (parent) {\n                var definition = new SchemaDefinition();\n                // support inheritance\n                definition.schema = Object.assign({}, parent && parent.schema || {});\n                definition.indexes = Object.assign({}, parent && parent.indexes || {});\n                definition.fieldsByIndex = Object.assign({}, parent && parent.fieldsByIndex || {});\n                definition.descriptors = Object.assign({}, parent && parent.descriptors || {});\n                definition.deprecated = Object.assign({}, parent && parent.deprecated || {});\n                return definition;\n            };\n            SchemaDefinition.prototype.addField = function (field, type) {\n                var index = this.getNextFieldIndex();\n                this.fieldsByIndex[index] = field;\n                this.indexes[field] = index;\n                this.schema[field] = (Array.isArray(type))\n                    ? { array: type[0] }\n                    : type;\n            };\n            SchemaDefinition.prototype.addFilter = function (field, cb) {\n                if (!this.filters) {\n                    this.filters = {};\n                    this.indexesWithFilters = [];\n                }\n                this.filters[this.indexes[field]] = cb;\n                this.indexesWithFilters.push(this.indexes[field]);\n                return true;\n            };\n            SchemaDefinition.prototype.addChildrenFilter = function (field, cb) {\n                var index = this.indexes[field];\n                var type = this.schema[field];\n                if (getType(Object.keys(type)[0])) {\n                    if (!this.childFilters) {\n                        this.childFilters = {};\n                    }\n                    this.childFilters[index] = cb;\n                    return true;\n                }\n                else {\n                    console.warn(\"@filterChildren: field '\" + field + \"' can't have children. Ignoring filter.\");\n                }\n            };\n            SchemaDefinition.prototype.getChildrenFilter = function (field) {\n                return this.childFilters && this.childFilters[this.indexes[field]];\n            };\n            SchemaDefinition.prototype.getNextFieldIndex = function () {\n                return Object.keys(this.schema || {}).length;\n            };\n            return SchemaDefinition;\n        }());\n        function hasFilter(klass) {\n            return klass._context && klass._context.useFilters;\n        }\n        var Context = /** @class */ (function () {\n            function Context() {\n                this.types = {};\n                this.schemas = new Map();\n                this.useFilters = false;\n            }\n            Context.prototype.has = function (schema) {\n                return this.schemas.has(schema);\n            };\n            Context.prototype.get = function (typeid) {\n                return this.types[typeid];\n            };\n            Context.prototype.add = function (schema, typeid) {\n                if (typeid === void 0) { typeid = this.schemas.size; }\n                // FIXME: move this to somewhere else?\n                // support inheritance\n                schema._definition = SchemaDefinition.create(schema._definition);\n                schema._typeid = typeid;\n                this.types[typeid] = schema;\n                this.schemas.set(schema, typeid);\n            };\n            Context.create = function (context) {\n                if (context === void 0) { context = new Context; }\n                return function (definition) {\n                    return type(definition, context);\n                };\n            };\n            return Context;\n        }());\n        var globalContext = new Context();\n        /**\n         * `@type()` decorator for proxies\n         */\n        function type(type, context) {\n            if (context === void 0) { context = globalContext; }\n            return function (target, field) {\n                var constructor = target.constructor;\n                constructor._context = context;\n                /*\n                 * static schema\n                 */\n                if (!context.has(constructor)) {\n                    context.add(constructor);\n                }\n                var definition = constructor._definition;\n                definition.addField(field, type);\n                /**\n                 * skip if descriptor already exists for this field (`@deprecated()`)\n                 */\n                if (definition.descriptors[field]) {\n                    if (definition.deprecated[field]) {\n                        // do not create accessors for deprecated properties.\n                        return;\n                    }\n                    else {\n                        // trying to define same property multiple times across inheritance.\n                        // https://github.com/colyseus/colyseus-unity3d/issues/131#issuecomment-814308572\n                        try {\n                            throw new Error(\"@colyseus/schema: Duplicate '\" + field + \"' definition on '\" + constructor.name + \"'.\\nCheck @type() annotation\");\n                        }\n                        catch (e) {\n                            var definitionAtLine = e.stack.split(\"\\n\")[4].trim();\n                            throw new Error(e.message + \" \" + definitionAtLine);\n                        }\n                    }\n                }\n                var isArray = ArraySchema.is(type);\n                var isMap = !isArray && MapSchema.is(type);\n                // TODO: refactor me.\n                // Allow abstract intermediary classes with no fields to be serialized\n                // (See \"should support an inheritance with a Schema type without fields\" test)\n                if (typeof (type) !== \"string\" && !Schema.is(type)) {\n                    var childType = Object.values(type)[0];\n                    if (typeof (childType) !== \"string\" && !context.has(childType)) {\n                        context.add(childType);\n                    }\n                }\n                var fieldCached = \"_\" + field;\n                definition.descriptors[fieldCached] = {\n                    enumerable: false,\n                    configurable: false,\n                    writable: true,\n                };\n                definition.descriptors[field] = {\n                    get: function () {\n                        return this[fieldCached];\n                    },\n                    set: function (value) {\n                        /**\n                         * Create Proxy for array or map items\n                         */\n                        // skip if value is the same as cached.\n                        if (value === this[fieldCached]) {\n                            return;\n                        }\n                        if (value !== undefined &&\n                            value !== null) {\n                            // automaticallty transform Array into ArraySchema\n                            if (isArray && !(value instanceof ArraySchema)) {\n                                value = new (ArraySchema.bind.apply(ArraySchema, __spreadArray([void 0], value)))();\n                            }\n                            // automaticallty transform Map into MapSchema\n                            if (isMap && !(value instanceof MapSchema)) {\n                                value = new MapSchema(value);\n                            }\n                            // try to turn provided structure into a Proxy\n                            if (value['$proxy'] === undefined) {\n                                if (isMap) {\n                                    value = getMapProxy(value);\n                                }\n                                else if (isArray) {\n                                    value = getArrayProxy(value);\n                                }\n                            }\n                            // flag the change for encoding.\n                            this.$changes.change(field);\n                            //\n                            // call setParent() recursively for this and its child\n                            // structures.\n                            //\n                            if (value['$changes']) {\n                                value['$changes'].setParent(this, this.$changes.root, this._definition.indexes[field]);\n                            }\n                        }\n                        else {\n                            //\n                            // Setting a field to `null` or `undefined` will delete it.\n                            //\n                            this.$changes.delete(field);\n                        }\n                        this[fieldCached] = value;\n                    },\n                    enumerable: true,\n                    configurable: true\n                };\n            };\n        }\n        /**\n         * `@filter()` decorator for defining data filters per client\n         */\n        function filter(cb) {\n            return function (target, field) {\n                var constructor = target.constructor;\n                var definition = constructor._definition;\n                if (definition.addFilter(field, cb)) {\n                    constructor._context.useFilters = true;\n                }\n            };\n        }\n        function filterChildren(cb) {\n            return function (target, field) {\n                var constructor = target.constructor;\n                var definition = constructor._definition;\n                if (definition.addChildrenFilter(field, cb)) {\n                    constructor._context.useFilters = true;\n                }\n            };\n        }\n        /**\n         * `@deprecated()` flag a field as deprecated.\n         * The previous `@type()` annotation should remain along with this one.\n         */\n        function deprecated(throws, context) {\n            if (throws === void 0) { throws = true; }\n            return function (target, field) {\n                var constructor = target.constructor;\n                var definition = constructor._definition;\n                definition.deprecated[field] = true;\n                if (throws) {\n                    definition.descriptors[field] = {\n                        get: function () { throw new Error(field + \" is deprecated.\"); },\n                        set: function (value) { },\n                        enumerable: false,\n                        configurable: true\n                    };\n                }\n            };\n        }\n        function defineTypes(target, fields, context) {\n            if (context === void 0) { context = target._context || globalContext; }\n            for (var field in fields) {\n                type(fields[field], context)(target.prototype, field);\n            }\n            return target;\n        }\n\n        /**\n         * Copyright (c) 2018 Endel Dreyer\n         * Copyright (c) 2014 Ion Drive Software Ltd.\n         *\n         * Permission is hereby granted, free of charge, to any person obtaining a copy\n         * of this software and associated documentation files (the \"Software\"), to deal\n         * in the Software without restriction, including without limitation the rights\n         * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n         * copies of the Software, and to permit persons to whom the Software is\n         * furnished to do so, subject to the following conditions:\n         *\n         * The above copyright notice and this permission notice shall be included in all\n         * copies or substantial portions of the Software.\n         *\n         * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n         * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n         * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n         * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n         * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n         * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n         * SOFTWARE\n         */\n        /**\n         * msgpack implementation highly based on notepack.io\n         * https://github.com/darrachequesne/notepack\n         */\n        function utf8Length(str) {\n            var c = 0, length = 0;\n            for (var i = 0, l = str.length; i < l; i++) {\n                c = str.charCodeAt(i);\n                if (c < 0x80) {\n                    length += 1;\n                }\n                else if (c < 0x800) {\n                    length += 2;\n                }\n                else if (c < 0xd800 || c >= 0xe000) {\n                    length += 3;\n                }\n                else {\n                    i++;\n                    length += 4;\n                }\n            }\n            return length;\n        }\n        function utf8Write(view, offset, str) {\n            var c = 0;\n            for (var i = 0, l = str.length; i < l; i++) {\n                c = str.charCodeAt(i);\n                if (c < 0x80) {\n                    view[offset++] = c;\n                }\n                else if (c < 0x800) {\n                    view[offset++] = 0xc0 | (c >> 6);\n                    view[offset++] = 0x80 | (c & 0x3f);\n                }\n                else if (c < 0xd800 || c >= 0xe000) {\n                    view[offset++] = 0xe0 | (c >> 12);\n                    view[offset++] = 0x80 | (c >> 6 & 0x3f);\n                    view[offset++] = 0x80 | (c & 0x3f);\n                }\n                else {\n                    i++;\n                    c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\n                    view[offset++] = 0xf0 | (c >> 18);\n                    view[offset++] = 0x80 | (c >> 12 & 0x3f);\n                    view[offset++] = 0x80 | (c >> 6 & 0x3f);\n                    view[offset++] = 0x80 | (c & 0x3f);\n                }\n            }\n        }\n        function int8$1(bytes, value) {\n            bytes.push(value & 255);\n        }\n        function uint8$1(bytes, value) {\n            bytes.push(value & 255);\n        }\n        function int16$1(bytes, value) {\n            bytes.push(value & 255);\n            bytes.push((value >> 8) & 255);\n        }\n        function uint16$1(bytes, value) {\n            bytes.push(value & 255);\n            bytes.push((value >> 8) & 255);\n        }\n        function int32$1(bytes, value) {\n            bytes.push(value & 255);\n            bytes.push((value >> 8) & 255);\n            bytes.push((value >> 16) & 255);\n            bytes.push((value >> 24) & 255);\n        }\n        function uint32$1(bytes, value) {\n            var b4 = value >> 24;\n            var b3 = value >> 16;\n            var b2 = value >> 8;\n            var b1 = value;\n            bytes.push(b1 & 255);\n            bytes.push(b2 & 255);\n            bytes.push(b3 & 255);\n            bytes.push(b4 & 255);\n        }\n        function int64$1(bytes, value) {\n            var high = Math.floor(value / Math.pow(2, 32));\n            var low = value >>> 0;\n            uint32$1(bytes, low);\n            uint32$1(bytes, high);\n        }\n        function uint64$1(bytes, value) {\n            var high = (value / Math.pow(2, 32)) >> 0;\n            var low = value >>> 0;\n            uint32$1(bytes, low);\n            uint32$1(bytes, high);\n        }\n        function float32$1(bytes, value) {\n            writeFloat32(bytes, value);\n        }\n        function float64$1(bytes, value) {\n            writeFloat64(bytes, value);\n        }\n        var _int32$1 = new Int32Array(2);\n        var _float32$1 = new Float32Array(_int32$1.buffer);\n        var _float64$1 = new Float64Array(_int32$1.buffer);\n        function writeFloat32(bytes, value) {\n            _float32$1[0] = value;\n            int32$1(bytes, _int32$1[0]);\n        }\n        function writeFloat64(bytes, value) {\n            _float64$1[0] = value;\n            int32$1(bytes, _int32$1[0 ]);\n            int32$1(bytes, _int32$1[1 ]);\n        }\n        function boolean$1(bytes, value) {\n            return uint8$1(bytes, value ? 1 : 0);\n        }\n        function string$1(bytes, value) {\n            // encode `null` strings as empty.\n            if (!value) {\n                value = \"\";\n            }\n            var length = utf8Length(value);\n            var size = 0;\n            // fixstr\n            if (length < 0x20) {\n                bytes.push(length | 0xa0);\n                size = 1;\n            }\n            // str 8\n            else if (length < 0x100) {\n                bytes.push(0xd9);\n                uint8$1(bytes, length);\n                size = 2;\n            }\n            // str 16\n            else if (length < 0x10000) {\n                bytes.push(0xda);\n                uint16$1(bytes, length);\n                size = 3;\n            }\n            // str 32\n            else if (length < 0x100000000) {\n                bytes.push(0xdb);\n                uint32$1(bytes, length);\n                size = 5;\n            }\n            else {\n                throw new Error('String too long');\n            }\n            utf8Write(bytes, bytes.length, value);\n            return size + length;\n        }\n        function number$1(bytes, value) {\n            if (isNaN(value)) {\n                return number$1(bytes, 0);\n            }\n            else if (!isFinite(value)) {\n                return number$1(bytes, (value > 0) ? Number.MAX_SAFE_INTEGER : -Number.MAX_SAFE_INTEGER);\n            }\n            else if (value !== (value | 0)) {\n                bytes.push(0xcb);\n                writeFloat64(bytes, value);\n                return 9;\n                // TODO: encode float 32?\n                // is it possible to differentiate between float32 / float64 here?\n                // // float 32\n                // bytes.push(0xca);\n                // writeFloat32(bytes, value);\n                // return 5;\n            }\n            if (value >= 0) {\n                // positive fixnum\n                if (value < 0x80) {\n                    uint8$1(bytes, value);\n                    return 1;\n                }\n                // uint 8\n                if (value < 0x100) {\n                    bytes.push(0xcc);\n                    uint8$1(bytes, value);\n                    return 2;\n                }\n                // uint 16\n                if (value < 0x10000) {\n                    bytes.push(0xcd);\n                    uint16$1(bytes, value);\n                    return 3;\n                }\n                // uint 32\n                if (value < 0x100000000) {\n                    bytes.push(0xce);\n                    uint32$1(bytes, value);\n                    return 5;\n                }\n                // uint 64\n                bytes.push(0xcf);\n                uint64$1(bytes, value);\n                return 9;\n            }\n            else {\n                // negative fixnum\n                if (value >= -0x20) {\n                    bytes.push(0xe0 | (value + 0x20));\n                    return 1;\n                }\n                // int 8\n                if (value >= -0x80) {\n                    bytes.push(0xd0);\n                    int8$1(bytes, value);\n                    return 2;\n                }\n                // int 16\n                if (value >= -0x8000) {\n                    bytes.push(0xd1);\n                    int16$1(bytes, value);\n                    return 3;\n                }\n                // int 32\n                if (value >= -0x80000000) {\n                    bytes.push(0xd2);\n                    int32$1(bytes, value);\n                    return 5;\n                }\n                // int 64\n                bytes.push(0xd3);\n                int64$1(bytes, value);\n                return 9;\n            }\n        }\n\n        var encode = /*#__PURE__*/Object.freeze({\n            __proto__: null,\n            utf8Write: utf8Write,\n            int8: int8$1,\n            uint8: uint8$1,\n            int16: int16$1,\n            uint16: uint16$1,\n            int32: int32$1,\n            uint32: uint32$1,\n            int64: int64$1,\n            uint64: uint64$1,\n            float32: float32$1,\n            float64: float64$1,\n            writeFloat32: writeFloat32,\n            writeFloat64: writeFloat64,\n            boolean: boolean$1,\n            string: string$1,\n            number: number$1\n        });\n\n        /**\n         * Copyright (c) 2018 Endel Dreyer\n         * Copyright (c) 2014 Ion Drive Software Ltd.\n         *\n         * Permission is hereby granted, free of charge, to any person obtaining a copy\n         * of this software and associated documentation files (the \"Software\"), to deal\n         * in the Software without restriction, including without limitation the rights\n         * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n         * copies of the Software, and to permit persons to whom the Software is\n         * furnished to do so, subject to the following conditions:\n         *\n         * The above copyright notice and this permission notice shall be included in all\n         * copies or substantial portions of the Software.\n         *\n         * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n         * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n         * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n         * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n         * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n         * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n         * SOFTWARE\n         */\n        function utf8Read(bytes, offset, length) {\n            var string = '', chr = 0;\n            for (var i = offset, end = offset + length; i < end; i++) {\n                var byte = bytes[i];\n                if ((byte & 0x80) === 0x00) {\n                    string += String.fromCharCode(byte);\n                    continue;\n                }\n                if ((byte & 0xe0) === 0xc0) {\n                    string += String.fromCharCode(((byte & 0x1f) << 6) |\n                        (bytes[++i] & 0x3f));\n                    continue;\n                }\n                if ((byte & 0xf0) === 0xe0) {\n                    string += String.fromCharCode(((byte & 0x0f) << 12) |\n                        ((bytes[++i] & 0x3f) << 6) |\n                        ((bytes[++i] & 0x3f) << 0));\n                    continue;\n                }\n                if ((byte & 0xf8) === 0xf0) {\n                    chr = ((byte & 0x07) << 18) |\n                        ((bytes[++i] & 0x3f) << 12) |\n                        ((bytes[++i] & 0x3f) << 6) |\n                        ((bytes[++i] & 0x3f) << 0);\n                    if (chr >= 0x010000) { // surrogate pair\n                        chr -= 0x010000;\n                        string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\n                    }\n                    else {\n                        string += String.fromCharCode(chr);\n                    }\n                    continue;\n                }\n                console.error('Invalid byte ' + byte.toString(16));\n                // (do not throw error to avoid server/client from crashing due to hack attemps)\n                // throw new Error('Invalid byte ' + byte.toString(16));\n            }\n            return string;\n        }\n        function int8(bytes, it) {\n            return uint8(bytes, it) << 24 >> 24;\n        }\n        function uint8(bytes, it) {\n            return bytes[it.offset++];\n        }\n        function int16(bytes, it) {\n            return uint16(bytes, it) << 16 >> 16;\n        }\n        function uint16(bytes, it) {\n            return bytes[it.offset++] | bytes[it.offset++] << 8;\n        }\n        function int32(bytes, it) {\n            return bytes[it.offset++] | bytes[it.offset++] << 8 | bytes[it.offset++] << 16 | bytes[it.offset++] << 24;\n        }\n        function uint32(bytes, it) {\n            return int32(bytes, it) >>> 0;\n        }\n        function float32(bytes, it) {\n            return readFloat32(bytes, it);\n        }\n        function float64(bytes, it) {\n            return readFloat64(bytes, it);\n        }\n        function int64(bytes, it) {\n            var low = uint32(bytes, it);\n            var high = int32(bytes, it) * Math.pow(2, 32);\n            return high + low;\n        }\n        function uint64(bytes, it) {\n            var low = uint32(bytes, it);\n            var high = uint32(bytes, it) * Math.pow(2, 32);\n            return high + low;\n        }\n        var _int32 = new Int32Array(2);\n        var _float32 = new Float32Array(_int32.buffer);\n        var _float64 = new Float64Array(_int32.buffer);\n        function readFloat32(bytes, it) {\n            _int32[0] = int32(bytes, it);\n            return _float32[0];\n        }\n        function readFloat64(bytes, it) {\n            _int32[0 ] = int32(bytes, it);\n            _int32[1 ] = int32(bytes, it);\n            return _float64[0];\n        }\n        function boolean(bytes, it) {\n            return uint8(bytes, it) > 0;\n        }\n        function string(bytes, it) {\n            var prefix = bytes[it.offset++];\n            var length;\n            if (prefix < 0xc0) {\n                // fixstr\n                length = prefix & 0x1f;\n            }\n            else if (prefix === 0xd9) {\n                length = uint8(bytes, it);\n            }\n            else if (prefix === 0xda) {\n                length = uint16(bytes, it);\n            }\n            else if (prefix === 0xdb) {\n                length = uint32(bytes, it);\n            }\n            var value = utf8Read(bytes, it.offset, length);\n            it.offset += length;\n            return value;\n        }\n        function stringCheck(bytes, it) {\n            var prefix = bytes[it.offset];\n            return (\n            // fixstr\n            (prefix < 0xc0 && prefix > 0xa0) ||\n                // str 8\n                prefix === 0xd9 ||\n                // str 16\n                prefix === 0xda ||\n                // str 32\n                prefix === 0xdb);\n        }\n        function number(bytes, it) {\n            var prefix = bytes[it.offset++];\n            if (prefix < 0x80) {\n                // positive fixint\n                return prefix;\n            }\n            else if (prefix === 0xca) {\n                // float 32\n                return readFloat32(bytes, it);\n            }\n            else if (prefix === 0xcb) {\n                // float 64\n                return readFloat64(bytes, it);\n            }\n            else if (prefix === 0xcc) {\n                // uint 8\n                return uint8(bytes, it);\n            }\n            else if (prefix === 0xcd) {\n                // uint 16\n                return uint16(bytes, it);\n            }\n            else if (prefix === 0xce) {\n                // uint 32\n                return uint32(bytes, it);\n            }\n            else if (prefix === 0xcf) {\n                // uint 64\n                return uint64(bytes, it);\n            }\n            else if (prefix === 0xd0) {\n                // int 8\n                return int8(bytes, it);\n            }\n            else if (prefix === 0xd1) {\n                // int 16\n                return int16(bytes, it);\n            }\n            else if (prefix === 0xd2) {\n                // int 32\n                return int32(bytes, it);\n            }\n            else if (prefix === 0xd3) {\n                // int 64\n                return int64(bytes, it);\n            }\n            else if (prefix > 0xdf) {\n                // negative fixint\n                return (0xff - prefix + 1) * -1;\n            }\n        }\n        function numberCheck(bytes, it) {\n            var prefix = bytes[it.offset];\n            // positive fixint - 0x00 - 0x7f\n            // float 32        - 0xca\n            // float 64        - 0xcb\n            // uint 8          - 0xcc\n            // uint 16         - 0xcd\n            // uint 32         - 0xce\n            // uint 64         - 0xcf\n            // int 8           - 0xd0\n            // int 16          - 0xd1\n            // int 32          - 0xd2\n            // int 64          - 0xd3\n            return (prefix < 0x80 ||\n                (prefix >= 0xca && prefix <= 0xd3));\n        }\n        function arrayCheck(bytes, it) {\n            return bytes[it.offset] < 0xa0;\n            // const prefix = bytes[it.offset] ;\n            // if (prefix < 0xa0) {\n            //   return prefix;\n            // // array\n            // } else if (prefix === 0xdc) {\n            //   it.offset += 2;\n            // } else if (0xdd) {\n            //   it.offset += 4;\n            // }\n            // return prefix;\n        }\n        function switchStructureCheck(bytes, it) {\n            return (\n            // previous byte should be `SWITCH_TO_STRUCTURE`\n            bytes[it.offset - 1] === SWITCH_TO_STRUCTURE &&\n                // next byte should be a number\n                (bytes[it.offset] < 0x80 || (bytes[it.offset] >= 0xca && bytes[it.offset] <= 0xd3)));\n        }\n\n        var decode = /*#__PURE__*/Object.freeze({\n            __proto__: null,\n            int8: int8,\n            uint8: uint8,\n            int16: int16,\n            uint16: uint16,\n            int32: int32,\n            uint32: uint32,\n            float32: float32,\n            float64: float64,\n            int64: int64,\n            uint64: uint64,\n            readFloat32: readFloat32,\n            readFloat64: readFloat64,\n            boolean: boolean,\n            string: string,\n            stringCheck: stringCheck,\n            number: number,\n            numberCheck: numberCheck,\n            arrayCheck: arrayCheck,\n            switchStructureCheck: switchStructureCheck\n        });\n\n        var CollectionSchema = /** @class */ (function () {\n            function CollectionSchema(initialValues) {\n                var _this = this;\n                this.$changes = new ChangeTree(this);\n                this.$items = new Map();\n                this.$indexes = new Map();\n                this.$refId = 0;\n                if (initialValues) {\n                    initialValues.forEach(function (v) { return _this.add(v); });\n                }\n            }\n            CollectionSchema.is = function (type) {\n                return type['collection'] !== undefined;\n            };\n            CollectionSchema.prototype.add = function (value) {\n                // set \"index\" for reference.\n                var index = this.$refId++;\n                var isRef = (value['$changes']) !== undefined;\n                if (isRef) {\n                    value['$changes'].setParent(this, this.$changes.root, index);\n                }\n                this.$changes.indexes[index] = index;\n                this.$indexes.set(index, index);\n                this.$items.set(index, value);\n                this.$changes.change(index);\n                return index;\n            };\n            CollectionSchema.prototype.at = function (index) {\n                var key = Array.from(this.$items.keys())[index];\n                return this.$items.get(key);\n            };\n            CollectionSchema.prototype.entries = function () {\n                return this.$items.entries();\n            };\n            CollectionSchema.prototype.delete = function (item) {\n                var entries = this.$items.entries();\n                var index;\n                var entry;\n                while (entry = entries.next()) {\n                    if (entry.done) {\n                        break;\n                    }\n                    if (item === entry.value[1]) {\n                        index = entry.value[0];\n                        break;\n                    }\n                }\n                if (index === undefined) {\n                    return false;\n                }\n                this.$changes.delete(index);\n                this.$indexes.delete(index);\n                return this.$items.delete(index);\n            };\n            CollectionSchema.prototype.clear = function (isDecoding) {\n                var _this = this;\n                // discard previous operations.\n                this.$changes.discard(true, true);\n                this.$changes.indexes = {};\n                // clear previous indexes\n                this.$indexes.clear();\n                // flag child items for garbage collection.\n                if (isDecoding && typeof (this.$changes.getType()) !== \"string\") {\n                    this.$items.forEach(function (item) {\n                        _this.$changes.root.removeRef(item['$changes'].refId);\n                    });\n                }\n                // clear items\n                this.$items.clear();\n                this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                // touch all structures until reach root\n                this.$changes.touchParents();\n            };\n            CollectionSchema.prototype.has = function (value) {\n                return Array.from(this.$items.values()).some(function (v) { return v === value; });\n            };\n            CollectionSchema.prototype.forEach = function (callbackfn) {\n                var _this = this;\n                this.$items.forEach(function (value, key, _) { return callbackfn(value, key, _this); });\n            };\n            CollectionSchema.prototype.values = function () {\n                return this.$items.values();\n            };\n            Object.defineProperty(CollectionSchema.prototype, \"size\", {\n                get: function () {\n                    return this.$items.size;\n                },\n                enumerable: false,\n                configurable: true\n            });\n            CollectionSchema.prototype.setIndex = function (index, key) {\n                this.$indexes.set(index, key);\n            };\n            CollectionSchema.prototype.getIndex = function (index) {\n                return this.$indexes.get(index);\n            };\n            CollectionSchema.prototype.getByIndex = function (index) {\n                return this.$items.get(this.$indexes.get(index));\n            };\n            CollectionSchema.prototype.deleteByIndex = function (index) {\n                var key = this.$indexes.get(index);\n                this.$items.delete(key);\n                this.$indexes.delete(index);\n            };\n            CollectionSchema.prototype.toArray = function () {\n                return Array.from(this.$items.values());\n            };\n            CollectionSchema.prototype.toJSON = function () {\n                var values = [];\n                this.forEach(function (value, key) {\n                    values.push((typeof (value['toJSON']) === \"function\")\n                        ? value['toJSON']()\n                        : value);\n                });\n                return values;\n            };\n            //\n            // Decoding utilities\n            //\n            CollectionSchema.prototype.clone = function (isDecoding) {\n                var cloned;\n                if (isDecoding) {\n                    // client-side\n                    cloned = Object.assign(new CollectionSchema(), this);\n                }\n                else {\n                    // server-side\n                    cloned = new CollectionSchema();\n                    this.forEach(function (value) {\n                        if (value['$changes']) {\n                            cloned.add(value['clone']());\n                        }\n                        else {\n                            cloned.add(value);\n                        }\n                    });\n                }\n                return cloned;\n            };\n            CollectionSchema.prototype.triggerAll = function () {\n                Schema.prototype.triggerAll.apply(this);\n            };\n            return CollectionSchema;\n        }());\n\n        var SetSchema = /** @class */ (function () {\n            function SetSchema(initialValues) {\n                var _this = this;\n                this.$changes = new ChangeTree(this);\n                this.$items = new Map();\n                this.$indexes = new Map();\n                this.$refId = 0;\n                if (initialValues) {\n                    initialValues.forEach(function (v) { return _this.add(v); });\n                }\n            }\n            SetSchema.is = function (type) {\n                return type['set'] !== undefined;\n            };\n            SetSchema.prototype.add = function (value) {\n                var _a, _b;\n                // immediatelly return false if value already added.\n                if (this.has(value)) {\n                    return false;\n                }\n                // set \"index\" for reference.\n                var index = this.$refId++;\n                if ((value['$changes']) !== undefined) {\n                    value['$changes'].setParent(this, this.$changes.root, index);\n                }\n                var operation = (_b = (_a = this.$changes.indexes[index]) === null || _a === void 0 ? void 0 : _a.op) !== null && _b !== void 0 ? _b : exports.OPERATION.ADD;\n                this.$changes.indexes[index] = index;\n                this.$indexes.set(index, index);\n                this.$items.set(index, value);\n                this.$changes.change(index, operation);\n                return index;\n            };\n            SetSchema.prototype.entries = function () {\n                return this.$items.entries();\n            };\n            SetSchema.prototype.delete = function (item) {\n                var entries = this.$items.entries();\n                var index;\n                var entry;\n                while (entry = entries.next()) {\n                    if (entry.done) {\n                        break;\n                    }\n                    if (item === entry.value[1]) {\n                        index = entry.value[0];\n                        break;\n                    }\n                }\n                if (index === undefined) {\n                    return false;\n                }\n                this.$changes.delete(index);\n                this.$indexes.delete(index);\n                return this.$items.delete(index);\n            };\n            SetSchema.prototype.clear = function (isDecoding) {\n                var _this = this;\n                // discard previous operations.\n                this.$changes.discard(true, true);\n                this.$changes.indexes = {};\n                // clear previous indexes\n                this.$indexes.clear();\n                // flag child items for garbage collection.\n                if (isDecoding && typeof (this.$changes.getType()) !== \"string\") {\n                    this.$items.forEach(function (item) {\n                        _this.$changes.root.removeRef(item['$changes'].refId);\n                    });\n                }\n                // clear items\n                this.$items.clear();\n                this.$changes.operation({ index: 0, op: exports.OPERATION.CLEAR });\n                // touch all structures until reach root\n                this.$changes.touchParents();\n            };\n            SetSchema.prototype.has = function (value) {\n                var values = this.$items.values();\n                var has = false;\n                var entry;\n                while (entry = values.next()) {\n                    if (entry.done) {\n                        break;\n                    }\n                    if (value === entry.value) {\n                        has = true;\n                        break;\n                    }\n                }\n                return has;\n            };\n            SetSchema.prototype.forEach = function (callbackfn) {\n                var _this = this;\n                this.$items.forEach(function (value, key, _) { return callbackfn(value, key, _this); });\n            };\n            SetSchema.prototype.values = function () {\n                return this.$items.values();\n            };\n            Object.defineProperty(SetSchema.prototype, \"size\", {\n                get: function () {\n                    return this.$items.size;\n                },\n                enumerable: false,\n                configurable: true\n            });\n            SetSchema.prototype.setIndex = function (index, key) {\n                this.$indexes.set(index, key);\n            };\n            SetSchema.prototype.getIndex = function (index) {\n                return this.$indexes.get(index);\n            };\n            SetSchema.prototype.getByIndex = function (index) {\n                return this.$items.get(this.$indexes.get(index));\n            };\n            SetSchema.prototype.deleteByIndex = function (index) {\n                var key = this.$indexes.get(index);\n                this.$items.delete(key);\n                this.$indexes.delete(index);\n            };\n            SetSchema.prototype.toArray = function () {\n                return Array.from(this.$items.values());\n            };\n            SetSchema.prototype.toJSON = function () {\n                var values = [];\n                this.forEach(function (value, key) {\n                    values.push((typeof (value['toJSON']) === \"function\")\n                        ? value['toJSON']()\n                        : value);\n                });\n                return values;\n            };\n            //\n            // Decoding utilities\n            //\n            SetSchema.prototype.clone = function (isDecoding) {\n                var cloned;\n                if (isDecoding) {\n                    // client-side\n                    cloned = Object.assign(new SetSchema(), this);\n                }\n                else {\n                    // server-side\n                    cloned = new SetSchema();\n                    this.forEach(function (value) {\n                        if (value['$changes']) {\n                            cloned.add(value['clone']());\n                        }\n                        else {\n                            cloned.add(value);\n                        }\n                    });\n                }\n                return cloned;\n            };\n            SetSchema.prototype.triggerAll = function () {\n                Schema.prototype.triggerAll.apply(this);\n            };\n            return SetSchema;\n        }());\n\n        /**\n         * Extracted from https://www.npmjs.com/package/strong-events\n         */\n        var EventEmitter_ = /** @class */ (function () {\n            function EventEmitter_() {\n                this.handlers = [];\n            }\n            EventEmitter_.prototype.register = function (cb, once) {\n                this.handlers.push(cb);\n                return this;\n            };\n            EventEmitter_.prototype.invoke = function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                this.handlers.forEach(function (handler) { return handler.apply(void 0, args); });\n            };\n            EventEmitter_.prototype.invokeAsync = function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return Promise.all(this.handlers.map(function (handler) { return handler.apply(void 0, args); }));\n            };\n            EventEmitter_.prototype.remove = function (cb) {\n                var index = this.handlers.indexOf(cb);\n                this.handlers[index] = this.handlers[this.handlers.length - 1];\n                this.handlers.pop();\n            };\n            EventEmitter_.prototype.clear = function () {\n                this.handlers = [];\n            };\n            return EventEmitter_;\n        }());\n\n        var ClientState = /** @class */ (function () {\n            function ClientState() {\n                this.refIds = new WeakSet();\n                this.containerIndexes = new WeakMap();\n            }\n            // containerIndexes = new Map<ChangeTree, Set<number>>();\n            ClientState.prototype.addRefId = function (changeTree) {\n                if (!this.refIds.has(changeTree)) {\n                    this.refIds.add(changeTree);\n                    this.containerIndexes.set(changeTree, new Set());\n                }\n            };\n            ClientState.get = function (client) {\n                if (client.$filterState === undefined) {\n                    client.$filterState = new ClientState();\n                }\n                return client.$filterState;\n            };\n            return ClientState;\n        }());\n\n        var EncodeSchemaError = /** @class */ (function (_super) {\n            __extends(EncodeSchemaError, _super);\n            function EncodeSchemaError() {\n                return _super !== null && _super.apply(this, arguments) || this;\n            }\n            return EncodeSchemaError;\n        }(Error));\n        function assertType(value, type, klass, field) {\n            var typeofTarget;\n            var allowNull = false;\n            switch (type) {\n                case \"number\":\n                case \"int8\":\n                case \"uint8\":\n                case \"int16\":\n                case \"uint16\":\n                case \"int32\":\n                case \"uint32\":\n                case \"int64\":\n                case \"uint64\":\n                case \"float32\":\n                case \"float64\":\n                    typeofTarget = \"number\";\n                    if (isNaN(value)) {\n                        console.log(\"trying to encode \\\"NaN\\\" in \" + klass.constructor.name + \"#\" + field);\n                    }\n                    break;\n                case \"string\":\n                    typeofTarget = \"string\";\n                    allowNull = true;\n                    break;\n                case \"boolean\":\n                    // boolean is always encoded as true/false based on truthiness\n                    return;\n            }\n            if (typeof (value) !== typeofTarget && (!allowNull || (allowNull && value !== null))) {\n                var foundValue = \"'\" + JSON.stringify(value) + \"'\" + ((value && value.constructor && \" (\" + value.constructor.name + \")\") || '');\n                throw new EncodeSchemaError(\"a '\" + typeofTarget + \"' was expected, but \" + foundValue + \" was provided in \" + klass.constructor.name + \"#\" + field);\n            }\n        }\n        function assertInstanceType(value, type, klass, field) {\n            if (!(value instanceof type)) {\n                throw new EncodeSchemaError(\"a '\" + type.name + \"' was expected, but '\" + value.constructor.name + \"' was provided in \" + klass.constructor.name + \"#\" + field);\n            }\n        }\n        function encodePrimitiveType(type, bytes, value, klass, field) {\n            assertType(value, type, klass, field);\n            var encodeFunc = encode[type];\n            if (encodeFunc) {\n                encodeFunc(bytes, value);\n            }\n            else {\n                throw new EncodeSchemaError(\"a '\" + type + \"' was expected, but \" + value + \" was provided in \" + klass.constructor.name + \"#\" + field);\n            }\n        }\n        function decodePrimitiveType(type, bytes, it) {\n            return decode[type](bytes, it);\n        }\n        /**\n         * Schema encoder / decoder\n         */\n        var Schema = /** @class */ (function () {\n            // allow inherited classes to have a constructor\n            function Schema() {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                // fix enumerability of fields for end-user\n                Object.defineProperties(this, {\n                    $changes: {\n                        value: new ChangeTree(this, undefined, new Root()),\n                        enumerable: false,\n                        writable: true\n                    },\n                    $listeners: {\n                        value: {},\n                        enumerable: false,\n                        writable: true\n                    },\n                });\n                var descriptors = this._definition.descriptors;\n                if (descriptors) {\n                    Object.defineProperties(this, descriptors);\n                }\n                //\n                // Assign initial values\n                //\n                if (args[0]) {\n                    this.assign(args[0]);\n                }\n            }\n            Schema.onError = function (e) {\n                console.error(e);\n            };\n            Schema.is = function (type) {\n                return (type['_definition'] &&\n                    type['_definition'].schema !== undefined);\n            };\n            Schema.prototype.assign = function (props) {\n                Object.assign(this, props);\n                return this;\n            };\n            Object.defineProperty(Schema.prototype, \"_definition\", {\n                get: function () { return this.constructor._definition; },\n                enumerable: false,\n                configurable: true\n            });\n            Schema.prototype.listen = function (attr, callback) {\n                var _this = this;\n                if (!this.$listeners[attr]) {\n                    this.$listeners[attr] = new EventEmitter_();\n                }\n                this.$listeners[attr].register(callback);\n                // return un-register callback.\n                return function () {\n                    return _this.$listeners[attr].remove(callback);\n                };\n            };\n            Schema.prototype.decode = function (bytes, it, ref, allChanges) {\n                if (it === void 0) { it = { offset: 0 }; }\n                if (ref === void 0) { ref = this; }\n                if (allChanges === void 0) { allChanges = new Map(); }\n                var $root = this.$changes.root;\n                var totalBytes = bytes.length;\n                var refId = 0;\n                var changes = [];\n                $root.refs.set(refId, this);\n                allChanges.set(refId, changes);\n                while (it.offset < totalBytes) {\n                    var byte = bytes[it.offset++];\n                    if (byte == SWITCH_TO_STRUCTURE) {\n                        refId = number(bytes, it);\n                        var nextRef = $root.refs.get(refId);\n                        //\n                        // Trying to access a reference that haven't been decoded yet.\n                        //\n                        if (!nextRef) {\n                            throw new Error(\"\\\"refId\\\" not found: \" + refId);\n                        }\n                        ref = nextRef;\n                        // create empty list of changes for this refId.\n                        changes = [];\n                        allChanges.set(refId, changes);\n                        continue;\n                    }\n                    var changeTree = ref['$changes'];\n                    var isSchema = (ref['_definition'] !== undefined);\n                    var operation = (isSchema)\n                        ? (byte >> 6) << 6 // \"compressed\" index + operation\n                        : byte; // \"uncompressed\" index + operation (array/map items)\n                    if (operation === exports.OPERATION.CLEAR) {\n                        //\n                        // TODO: refactor me!\n                        // The `.clear()` method is calling `$root.removeRef(refId)` for\n                        // each item inside this collection\n                        //\n                        ref.clear(true);\n                        continue;\n                    }\n                    var fieldIndex = (isSchema)\n                        ? byte % (operation || 255) // if \"REPLACE\" operation (0), use 255\n                        : number(bytes, it);\n                    var fieldName = (isSchema)\n                        ? (ref['_definition'].fieldsByIndex[fieldIndex])\n                        : \"\";\n                    var type = changeTree.getType(fieldIndex);\n                    var value = void 0;\n                    var previousValue = void 0;\n                    var dynamicIndex = void 0;\n                    if (!isSchema) {\n                        previousValue = ref['getByIndex'](fieldIndex);\n                        if ((operation & exports.OPERATION.ADD) === exports.OPERATION.ADD) { // ADD or DELETE_AND_ADD\n                            dynamicIndex = (ref instanceof MapSchema)\n                                ? string(bytes, it)\n                                : fieldIndex;\n                            ref['setIndex'](fieldIndex, dynamicIndex);\n                        }\n                        else {\n                            // here\n                            dynamicIndex = ref['getIndex'](fieldIndex);\n                        }\n                    }\n                    else {\n                        previousValue = ref[\"_\" + fieldName];\n                    }\n                    //\n                    // Delete operations\n                    //\n                    if ((operation & exports.OPERATION.DELETE) === exports.OPERATION.DELETE) {\n                        if (operation !== exports.OPERATION.DELETE_AND_ADD) {\n                            ref['deleteByIndex'](fieldIndex);\n                        }\n                        // Flag `refId` for garbage collection.\n                        if (previousValue && previousValue['$changes']) {\n                            $root.removeRef(previousValue['$changes'].refId);\n                        }\n                        value = null;\n                    }\n                    if (fieldName === undefined) {\n                        console.warn(\"@colyseus/schema: definition mismatch\");\n                        //\n                        // keep skipping next bytes until reaches a known structure\n                        // by local decoder.\n                        //\n                        var nextIterator = { offset: it.offset };\n                        while (it.offset < totalBytes) {\n                            if (switchStructureCheck(bytes, it)) {\n                                nextIterator.offset = it.offset + 1;\n                                if ($root.refs.has(number(bytes, nextIterator))) {\n                                    break;\n                                }\n                            }\n                            it.offset++;\n                        }\n                        continue;\n                    }\n                    else if (operation === exports.OPERATION.DELETE) ;\n                    else if (Schema.is(type)) {\n                        var refId_1 = number(bytes, it);\n                        value = $root.refs.get(refId_1);\n                        if (operation !== exports.OPERATION.REPLACE) {\n                            var childType = this.getSchemaType(bytes, it, type);\n                            if (!value) {\n                                value = this.createTypeInstance(childType);\n                                value.$changes.refId = refId_1;\n                                if (previousValue) {\n                                    value.onChange = previousValue.onChange;\n                                    value.onRemove = previousValue.onRemove;\n                                    value.$listeners = previousValue.$listeners;\n                                    if (previousValue['$changes'].refId &&\n                                        refId_1 !== previousValue['$changes'].refId) {\n                                        $root.removeRef(previousValue['$changes'].refId);\n                                    }\n                                }\n                            }\n                            $root.addRef(refId_1, value, (value !== previousValue));\n                        }\n                    }\n                    else if (typeof (type) === \"string\") {\n                        //\n                        // primitive value (number, string, boolean, etc)\n                        //\n                        value = decodePrimitiveType(type, bytes, it);\n                    }\n                    else {\n                        var typeDef = getType(Object.keys(type)[0]);\n                        var refId_2 = number(bytes, it);\n                        var valueRef = ($root.refs.has(refId_2))\n                            ? previousValue || $root.refs.get(refId_2)\n                            : new typeDef.constructor();\n                        value = valueRef.clone(true);\n                        value.$changes.refId = refId_2;\n                        // preserve schema callbacks\n                        if (previousValue) {\n                            value.onAdd = previousValue.onAdd;\n                            value.onRemove = previousValue.onRemove;\n                            value.onChange = previousValue.onChange;\n                            if (previousValue['$changes'].refId &&\n                                refId_2 !== previousValue['$changes'].refId) {\n                                $root.removeRef(previousValue['$changes'].refId);\n                                //\n                                // Trigger onRemove if structure has been replaced.\n                                //\n                                var deletes = [];\n                                var entries = previousValue.entries();\n                                var iter = void 0;\n                                while ((iter = entries.next()) && !iter.done) {\n                                    var _a = iter.value, key = _a[0], value_1 = _a[1];\n                                    deletes.push({\n                                        op: exports.OPERATION.DELETE,\n                                        field: key,\n                                        value: undefined,\n                                        previousValue: value_1,\n                                    });\n                                }\n                                allChanges.set(previousValue['$changes'].refId, deletes);\n                            }\n                        }\n                        $root.addRef(refId_2, value, (valueRef !== previousValue));\n                        //\n                        // TODO: deprecate proxies on next version.\n                        // get proxy to target value.\n                        //\n                        if (typeDef.getProxy) {\n                            value = typeDef.getProxy(value);\n                        }\n                    }\n                    var hasChange = (previousValue !== value);\n                    if (value !== null &&\n                        value !== undefined) {\n                        if (value['$changes']) {\n                            value['$changes'].setParent(changeTree.ref, changeTree.root, fieldIndex);\n                        }\n                        if (ref instanceof Schema) {\n                            ref[fieldName] = value;\n                            //\n                            // FIXME: use `_field` instead of `field`.\n                            //\n                            // `field` is going to use the setter of the PropertyDescriptor\n                            // and create a proxy for array/map. This is only useful for\n                            // backwards-compatibility with @colyseus/schema@0.5.x\n                            //\n                            // // ref[_field] = value;\n                        }\n                        else if (ref instanceof MapSchema) {\n                            // const key = ref['$indexes'].get(field);\n                            var key = dynamicIndex;\n                            // ref.set(key, value);\n                            ref['$items'].set(key, value);\n                        }\n                        else if (ref instanceof ArraySchema) {\n                            // const key = ref['$indexes'][field];\n                            // console.log(\"SETTING FOR ArraySchema =>\", { field, key, value });\n                            // ref[key] = value;\n                            ref.setAt(fieldIndex, value);\n                        }\n                        else if (ref instanceof CollectionSchema) {\n                            var index = ref.add(value);\n                            ref['setIndex'](fieldIndex, index);\n                        }\n                        else if (ref instanceof SetSchema) {\n                            var index = ref.add(value);\n                            if (index !== false) {\n                                ref['setIndex'](fieldIndex, index);\n                            }\n                        }\n                    }\n                    if (hasChange\n                    // &&\n                    // (\n                    //     this.onChange || ref.$listeners[field]\n                    // )\n                    ) {\n                        changes.push({\n                            op: operation,\n                            field: fieldName,\n                            dynamicIndex: dynamicIndex,\n                            value: value,\n                            previousValue: previousValue,\n                        });\n                    }\n                }\n                this._triggerChanges(allChanges);\n                // drop references of unused schemas\n                $root.garbageCollectDeletedRefs();\n                return allChanges;\n            };\n            Schema.prototype.encode = function (encodeAll, bytes, useFilters) {\n                if (encodeAll === void 0) { encodeAll = false; }\n                if (bytes === void 0) { bytes = []; }\n                if (useFilters === void 0) { useFilters = false; }\n                var rootChangeTree = this.$changes;\n                var refIdsVisited = new WeakSet();\n                var changeTrees = [rootChangeTree];\n                var numChangeTrees = 1;\n                for (var i = 0; i < numChangeTrees; i++) {\n                    var changeTree = changeTrees[i];\n                    var ref = changeTree.ref;\n                    var isSchema = (ref instanceof Schema);\n                    // Generate unique refId for the ChangeTree.\n                    changeTree.ensureRefId();\n                    // mark this ChangeTree as visited.\n                    refIdsVisited.add(changeTree);\n                    // root `refId` is skipped.\n                    if (changeTree !== rootChangeTree &&\n                        (changeTree.changed || encodeAll)) {\n                        uint8$1(bytes, SWITCH_TO_STRUCTURE);\n                        number$1(bytes, changeTree.refId);\n                    }\n                    var changes = (encodeAll)\n                        ? Array.from(changeTree.allChanges)\n                        : Array.from(changeTree.changes.values());\n                    for (var j = 0, cl = changes.length; j < cl; j++) {\n                        var operation = (encodeAll)\n                            ? { op: exports.OPERATION.ADD, index: changes[j] }\n                            : changes[j];\n                        var fieldIndex = operation.index;\n                        var field = (isSchema)\n                            ? ref['_definition'].fieldsByIndex && ref['_definition'].fieldsByIndex[fieldIndex]\n                            : fieldIndex;\n                        // cache begin index if `useFilters`\n                        var beginIndex = bytes.length;\n                        // encode field index + operation\n                        if (operation.op !== exports.OPERATION.TOUCH) {\n                            if (isSchema) {\n                                //\n                                // Compress `fieldIndex` + `operation` into a single byte.\n                                // This adds a limitaion of 64 fields per Schema structure\n                                //\n                                uint8$1(bytes, (fieldIndex | operation.op));\n                            }\n                            else {\n                                uint8$1(bytes, operation.op);\n                                // custom operations\n                                if (operation.op === exports.OPERATION.CLEAR) {\n                                    continue;\n                                }\n                                // indexed operations\n                                number$1(bytes, fieldIndex);\n                            }\n                        }\n                        //\n                        // encode \"alias\" for dynamic fields (maps)\n                        //\n                        if (!isSchema &&\n                            (operation.op & exports.OPERATION.ADD) == exports.OPERATION.ADD // ADD or DELETE_AND_ADD\n                        ) {\n                            if (ref instanceof MapSchema) {\n                                //\n                                // MapSchema dynamic key\n                                //\n                                var dynamicIndex = changeTree.ref['$indexes'].get(fieldIndex);\n                                string$1(bytes, dynamicIndex);\n                            }\n                        }\n                        if (operation.op === exports.OPERATION.DELETE) {\n                            //\n                            // TODO: delete from filter cache data.\n                            //\n                            // if (useFilters) {\n                            //     delete changeTree.caches[fieldIndex];\n                            // }\n                            continue;\n                        }\n                        // const type = changeTree.childType || ref._schema[field];\n                        var type = changeTree.getType(fieldIndex);\n                        // const type = changeTree.getType(fieldIndex);\n                        var value = changeTree.getValue(fieldIndex);\n                        // Enqueue ChangeTree to be visited\n                        if (value &&\n                            value['$changes'] &&\n                            !refIdsVisited.has(value['$changes'])) {\n                            changeTrees.push(value['$changes']);\n                            value['$changes'].ensureRefId();\n                            numChangeTrees++;\n                        }\n                        if (operation.op === exports.OPERATION.TOUCH) {\n                            continue;\n                        }\n                        if (Schema.is(type)) {\n                            assertInstanceType(value, type, ref, field);\n                            //\n                            // Encode refId for this instance.\n                            // The actual instance is going to be encoded on next `changeTree` iteration.\n                            //\n                            number$1(bytes, value.$changes.refId);\n                            // Try to encode inherited TYPE_ID if it's an ADD operation.\n                            if ((operation.op & exports.OPERATION.ADD) === exports.OPERATION.ADD) {\n                                this.tryEncodeTypeId(bytes, type, value.constructor);\n                            }\n                        }\n                        else if (typeof (type) === \"string\") {\n                            //\n                            // Primitive values\n                            //\n                            encodePrimitiveType(type, bytes, value, ref, field);\n                        }\n                        else {\n                            //\n                            // Custom type (MapSchema, ArraySchema, etc)\n                            //\n                            var definition = getType(Object.keys(type)[0]);\n                            //\n                            // ensure a ArraySchema has been provided\n                            //\n                            assertInstanceType(ref[\"_\" + field], definition.constructor, ref, field);\n                            //\n                            // Encode refId for this instance.\n                            // The actual instance is going to be encoded on next `changeTree` iteration.\n                            //\n                            number$1(bytes, value.$changes.refId);\n                        }\n                        if (useFilters) {\n                            // cache begin / end index\n                            changeTree.cache(fieldIndex, bytes.slice(beginIndex));\n                        }\n                    }\n                    if (!encodeAll && !useFilters) {\n                        changeTree.discard();\n                    }\n                }\n                return bytes;\n            };\n            Schema.prototype.encodeAll = function (useFilters) {\n                return this.encode(true, [], useFilters);\n            };\n            Schema.prototype.applyFilters = function (client, encodeAll) {\n                if (encodeAll === void 0) { encodeAll = false; }\n                var root = this;\n                var refIdsDissallowed = new Set();\n                var $filterState = ClientState.get(client);\n                var changeTrees = [this.$changes];\n                var numChangeTrees = 1;\n                var filteredBytes = [];\n                var _loop_1 = function (i) {\n                    var changeTree = changeTrees[i];\n                    if (refIdsDissallowed.has(changeTree.refId)) {\n                        return \"continue\";\n                    }\n                    var ref = changeTree.ref;\n                    var isSchema = ref instanceof Schema;\n                    uint8$1(filteredBytes, SWITCH_TO_STRUCTURE);\n                    number$1(filteredBytes, changeTree.refId);\n                    var clientHasRefId = $filterState.refIds.has(changeTree);\n                    var isEncodeAll = (encodeAll || !clientHasRefId);\n                    // console.log(\"REF:\", ref.constructor.name);\n                    // console.log(\"Encode all?\", isEncodeAll);\n                    //\n                    // include `changeTree` on list of known refIds by this client.\n                    //\n                    $filterState.addRefId(changeTree);\n                    var containerIndexes = $filterState.containerIndexes.get(changeTree);\n                    var changes = (isEncodeAll)\n                        ? Array.from(changeTree.allChanges)\n                        : Array.from(changeTree.changes.values());\n                    //\n                    // WORKAROUND: tries to re-evaluate previously not included @filter() attributes\n                    // - see \"DELETE a field of Schema\" test case.\n                    //\n                    if (!encodeAll &&\n                        isSchema &&\n                        ref._definition.indexesWithFilters) {\n                        var indexesWithFilters = ref._definition.indexesWithFilters;\n                        indexesWithFilters.forEach(function (indexWithFilter) {\n                            if (!containerIndexes.has(indexWithFilter) &&\n                                changeTree.allChanges.has(indexWithFilter)) {\n                                if (isEncodeAll) {\n                                    changes.push(indexWithFilter);\n                                }\n                                else {\n                                    changes.push({ op: exports.OPERATION.ADD, index: indexWithFilter, });\n                                }\n                            }\n                        });\n                    }\n                    for (var j = 0, cl = changes.length; j < cl; j++) {\n                        var change = (isEncodeAll)\n                            ? { op: exports.OPERATION.ADD, index: changes[j] }\n                            : changes[j];\n                        // custom operations\n                        if (change.op === exports.OPERATION.CLEAR) {\n                            uint8$1(filteredBytes, change.op);\n                            continue;\n                        }\n                        var fieldIndex = change.index;\n                        //\n                        // Deleting fields: encode the operation + field index\n                        //\n                        if (change.op === exports.OPERATION.DELETE) {\n                            //\n                            // DELETE operations also need to go through filtering.\n                            //\n                            // TODO: cache the previous value so we can access the value (primitive or `refId`)\n                            // (check against `$filterState.refIds`)\n                            //\n                            if (isSchema) {\n                                uint8$1(filteredBytes, change.op | fieldIndex);\n                            }\n                            else {\n                                uint8$1(filteredBytes, change.op);\n                                number$1(filteredBytes, fieldIndex);\n                            }\n                            continue;\n                        }\n                        // indexed operation\n                        var value = changeTree.getValue(fieldIndex);\n                        var type = changeTree.getType(fieldIndex);\n                        if (isSchema) {\n                            // Is a Schema!\n                            var filter = (ref._definition.filters &&\n                                ref._definition.filters[fieldIndex]);\n                            if (filter && !filter.call(ref, client, value, root)) {\n                                if (value && value['$changes']) {\n                                    refIdsDissallowed.add(value['$changes'].refId);\n                                }\n                                continue;\n                            }\n                        }\n                        else {\n                            // Is a collection! (map, array, etc.)\n                            var parent = changeTree.parent;\n                            var filter = changeTree.getChildrenFilter();\n                            if (filter && !filter.call(parent, client, ref['$indexes'].get(fieldIndex), value, root)) {\n                                if (value && value['$changes']) {\n                                    refIdsDissallowed.add(value['$changes'].refId);\n                                }\n                                continue;\n                            }\n                        }\n                        // visit child ChangeTree on further iteration.\n                        if (value['$changes']) {\n                            changeTrees.push(value['$changes']);\n                            numChangeTrees++;\n                        }\n                        //\n                        // Copy cached bytes\n                        //\n                        if (change.op !== exports.OPERATION.TOUCH) {\n                            //\n                            // TODO: refactor me!\n                            //\n                            if (change.op === exports.OPERATION.ADD || isSchema) {\n                                //\n                                // use cached bytes directly if is from Schema type.\n                                //\n                                filteredBytes = filteredBytes.concat(changeTree.caches[fieldIndex]);\n                                containerIndexes.add(fieldIndex);\n                            }\n                            else {\n                                if (containerIndexes.has(fieldIndex)) {\n                                    //\n                                    // use cached bytes if already has the field\n                                    //\n                                    filteredBytes = filteredBytes.concat(changeTree.caches[fieldIndex]);\n                                }\n                                else {\n                                    //\n                                    // force ADD operation if field is not known by this client.\n                                    //\n                                    containerIndexes.add(fieldIndex);\n                                    uint8$1(filteredBytes, exports.OPERATION.ADD);\n                                    number$1(filteredBytes, fieldIndex);\n                                    if (ref instanceof MapSchema) {\n                                        //\n                                        // MapSchema dynamic key\n                                        //\n                                        var dynamicIndex = changeTree.ref['$indexes'].get(fieldIndex);\n                                        string$1(filteredBytes, dynamicIndex);\n                                    }\n                                    if (value['$changes']) {\n                                        number$1(filteredBytes, value['$changes'].refId);\n                                    }\n                                    else {\n                                        // \"encodePrimitiveType\" without type checking.\n                                        // the type checking has been done on the first .encode() call.\n                                        encode[type](filteredBytes, value);\n                                    }\n                                }\n                            }\n                        }\n                        else if (value['$changes'] && !isSchema) {\n                            //\n                            // TODO:\n                            // - track ADD/REPLACE/DELETE instances on `$filterState`\n                            // - do NOT always encode dynamicIndex for MapSchema.\n                            //   (If client already has that key, only the first index is necessary.)\n                            //\n                            uint8$1(filteredBytes, exports.OPERATION.ADD);\n                            number$1(filteredBytes, fieldIndex);\n                            if (ref instanceof MapSchema) {\n                                //\n                                // MapSchema dynamic key\n                                //\n                                var dynamicIndex = changeTree.ref['$indexes'].get(fieldIndex);\n                                string$1(filteredBytes, dynamicIndex);\n                            }\n                            number$1(filteredBytes, value['$changes'].refId);\n                        }\n                    }\n                };\n                for (var i = 0; i < numChangeTrees; i++) {\n                    _loop_1(i);\n                }\n                return filteredBytes;\n            };\n            Schema.prototype.clone = function () {\n                var cloned = new (this.constructor);\n                var schema = this._definition.schema;\n                for (var field in schema) {\n                    if (typeof (this[field]) === \"object\" &&\n                        typeof (this[field].clone) === \"function\") {\n                        // deep clone\n                        cloned[field] = this[field].clone();\n                    }\n                    else {\n                        // primitive values\n                        cloned[field] = this[field];\n                    }\n                }\n                return cloned;\n            };\n            Schema.prototype.triggerAll = function () {\n                // skip if haven't received any remote refs yet.\n                if (this.$changes.root.refs.size === 0) {\n                    return;\n                }\n                var allChanges = new Map();\n                Schema.prototype._triggerAllFillChanges.call(this, this, allChanges);\n                try {\n                    Schema.prototype._triggerChanges.call(this, allChanges);\n                }\n                catch (e) {\n                    Schema.onError(e);\n                }\n            };\n            Schema.prototype.toJSON = function () {\n                var schema = this._definition.schema;\n                var deprecated = this._definition.deprecated;\n                var obj = {};\n                for (var field in schema) {\n                    if (!deprecated[field] && this[field] !== null && typeof (this[field]) !== \"undefined\") {\n                        obj[field] = (typeof (this[field]['toJSON']) === \"function\")\n                            ? this[field]['toJSON']()\n                            : this[\"_\" + field];\n                    }\n                }\n                return obj;\n            };\n            Schema.prototype.discardAllChanges = function () {\n                this.$changes.discardAll();\n            };\n            Schema.prototype.getByIndex = function (index) {\n                return this[this._definition.fieldsByIndex[index]];\n            };\n            Schema.prototype.deleteByIndex = function (index) {\n                this[this._definition.fieldsByIndex[index]] = undefined;\n            };\n            Schema.prototype.tryEncodeTypeId = function (bytes, type, targetType) {\n                if (type._typeid !== targetType._typeid) {\n                    uint8$1(bytes, TYPE_ID);\n                    number$1(bytes, targetType._typeid);\n                }\n            };\n            Schema.prototype.getSchemaType = function (bytes, it, defaultType) {\n                var type;\n                if (bytes[it.offset] === TYPE_ID) {\n                    it.offset++;\n                    type = this.constructor._context.get(number(bytes, it));\n                }\n                return type || defaultType;\n            };\n            Schema.prototype.createTypeInstance = function (type) {\n                var instance = new type();\n                // assign root on $changes\n                instance.$changes.root = this.$changes.root;\n                return instance;\n            };\n            Schema.prototype._triggerAllFillChanges = function (ref, allChanges) {\n                if (allChanges.has(ref['$changes'].refId)) {\n                    return;\n                }\n                var changes = [];\n                allChanges.set(ref['$changes'].refId || 0, changes);\n                if (ref instanceof Schema) {\n                    var schema = ref._definition.schema;\n                    for (var fieldName in schema) {\n                        var _field = \"_\" + fieldName;\n                        var value = ref[_field];\n                        if (value !== undefined) {\n                            changes.push({\n                                op: exports.OPERATION.ADD,\n                                field: fieldName,\n                                value: value,\n                                previousValue: undefined\n                            });\n                            if (value['$changes'] !== undefined) {\n                                Schema.prototype._triggerAllFillChanges.call(this, value, allChanges);\n                            }\n                        }\n                    }\n                }\n                else {\n                    var entries = ref.entries();\n                    var iter = void 0;\n                    while ((iter = entries.next()) && !iter.done) {\n                        var _a = iter.value, key = _a[0], value = _a[1];\n                        changes.push({\n                            op: exports.OPERATION.ADD,\n                            field: key,\n                            dynamicIndex: key,\n                            value: value,\n                            previousValue: undefined,\n                        });\n                        if (value['$changes'] !== undefined) {\n                            Schema.prototype._triggerAllFillChanges.call(this, value, allChanges);\n                        }\n                    }\n                }\n            };\n            Schema.prototype._triggerChanges = function (allChanges) {\n                var _this = this;\n                allChanges.forEach(function (changes, refId) {\n                    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n                    if (changes.length > 0) {\n                        var ref = _this.$changes.root.refs.get(refId);\n                        var isSchema = ref instanceof Schema;\n                        for (var i = 0; i < changes.length; i++) {\n                            var change = changes[i];\n                            var listener = ref['$listeners'] && ref['$listeners'][change.field];\n                            if (!isSchema) {\n                                if (change.op === exports.OPERATION.ADD && change.previousValue === undefined) {\n                                    (_b = (_a = ref).onAdd) === null || _b === void 0 ? void 0 : _b.call(_a, change.value, (_c = change.dynamicIndex) !== null && _c !== void 0 ? _c : change.field);\n                                }\n                                else if (change.op === exports.OPERATION.DELETE) {\n                                    //\n                                    // FIXME: `previousValue` should always be avaiiable.\n                                    // ADD + DELETE operations are still encoding DELETE operation.\n                                    //\n                                    if (change.previousValue !== undefined) {\n                                        (_e = (_d = ref).onRemove) === null || _e === void 0 ? void 0 : _e.call(_d, change.previousValue, (_f = change.dynamicIndex) !== null && _f !== void 0 ? _f : change.field);\n                                    }\n                                }\n                                else if (change.op === exports.OPERATION.DELETE_AND_ADD) {\n                                    if (change.previousValue !== undefined) {\n                                        (_h = (_g = ref).onRemove) === null || _h === void 0 ? void 0 : _h.call(_g, change.previousValue, change.dynamicIndex);\n                                    }\n                                    (_k = (_j = ref).onAdd) === null || _k === void 0 ? void 0 : _k.call(_j, change.value, change.dynamicIndex);\n                                }\n                                else if (change.op === exports.OPERATION.REPLACE ||\n                                    change.value !== change.previousValue) {\n                                    (_m = (_l = ref).onChange) === null || _m === void 0 ? void 0 : _m.call(_l, change.value, change.dynamicIndex);\n                                }\n                            }\n                            //\n                            // trigger onRemove on child structure.\n                            //\n                            if ((change.op & exports.OPERATION.DELETE) === exports.OPERATION.DELETE &&\n                                change.previousValue instanceof Schema &&\n                                change.previousValue.onRemove) {\n                                change.previousValue.onRemove();\n                            }\n                            if (listener) {\n                                try {\n                                    listener.invoke(change.value, change.previousValue);\n                                }\n                                catch (e) {\n                                    Schema.onError(e);\n                                }\n                            }\n                        }\n                        if (isSchema) {\n                            if (ref.onChange) {\n                                try {\n                                    ref.onChange(changes);\n                                }\n                                catch (e) {\n                                    Schema.onError(e);\n                                }\n                            }\n                        }\n                    }\n                });\n            };\n            Schema._definition = SchemaDefinition.create();\n            return Schema;\n        }());\n\n        function dumpChanges(schema) {\n            var changeTrees = [schema['$changes']];\n            var numChangeTrees = 1;\n            var dump = {};\n            var currentStructure = dump;\n            var _loop_1 = function (i) {\n                var changeTree = changeTrees[i];\n                changeTree.changes.forEach(function (change) {\n                    var ref = changeTree.ref;\n                    var fieldIndex = change.index;\n                    var field = (ref['_definition'])\n                        ? ref['_definition'].fieldsByIndex[fieldIndex]\n                        : ref['$indexes'].get(fieldIndex);\n                    currentStructure[field] = changeTree.getValue(fieldIndex);\n                });\n            };\n            for (var i = 0; i < numChangeTrees; i++) {\n                _loop_1(i);\n            }\n            return dump;\n        }\n\n        var reflectionContext = new Context();\n        /**\n         * Reflection\n         */\n        var ReflectionField = /** @class */ (function (_super) {\n            __extends(ReflectionField, _super);\n            function ReflectionField() {\n                return _super !== null && _super.apply(this, arguments) || this;\n            }\n            __decorate([\n                type(\"string\", reflectionContext)\n            ], ReflectionField.prototype, \"name\", void 0);\n            __decorate([\n                type(\"string\", reflectionContext)\n            ], ReflectionField.prototype, \"type\", void 0);\n            __decorate([\n                type(\"number\", reflectionContext)\n            ], ReflectionField.prototype, \"referencedType\", void 0);\n            return ReflectionField;\n        }(Schema));\n        var ReflectionType = /** @class */ (function (_super) {\n            __extends(ReflectionType, _super);\n            function ReflectionType() {\n                var _this = _super !== null && _super.apply(this, arguments) || this;\n                _this.fields = new ArraySchema();\n                return _this;\n            }\n            __decorate([\n                type(\"number\", reflectionContext)\n            ], ReflectionType.prototype, \"id\", void 0);\n            __decorate([\n                type([ReflectionField], reflectionContext)\n            ], ReflectionType.prototype, \"fields\", void 0);\n            return ReflectionType;\n        }(Schema));\n        var Reflection = /** @class */ (function (_super) {\n            __extends(Reflection, _super);\n            function Reflection() {\n                var _this = _super !== null && _super.apply(this, arguments) || this;\n                _this.types = new ArraySchema();\n                return _this;\n            }\n            Reflection.encode = function (instance) {\n                var rootSchemaType = instance.constructor;\n                var reflection = new Reflection();\n                reflection.rootType = rootSchemaType._typeid;\n                var buildType = function (currentType, schema) {\n                    for (var fieldName in schema) {\n                        var field = new ReflectionField();\n                        field.name = fieldName;\n                        var fieldType = void 0;\n                        if (typeof (schema[fieldName]) === \"string\") {\n                            fieldType = schema[fieldName];\n                        }\n                        else {\n                            var type_1 = schema[fieldName];\n                            var childTypeSchema = void 0;\n                            //\n                            // TODO: refactor below.\n                            //\n                            if (Schema.is(type_1)) {\n                                fieldType = \"ref\";\n                                childTypeSchema = schema[fieldName];\n                            }\n                            else {\n                                fieldType = Object.keys(type_1)[0];\n                                if (typeof (type_1[fieldType]) === \"string\") {\n                                    fieldType += \":\" + type_1[fieldType]; // array:string\n                                }\n                                else {\n                                    childTypeSchema = type_1[fieldType];\n                                }\n                            }\n                            field.referencedType = (childTypeSchema)\n                                ? childTypeSchema._typeid\n                                : -1;\n                        }\n                        field.type = fieldType;\n                        currentType.fields.push(field);\n                    }\n                    reflection.types.push(currentType);\n                };\n                var types = rootSchemaType._context.types;\n                for (var typeid in types) {\n                    var type_2 = new ReflectionType();\n                    type_2.id = Number(typeid);\n                    buildType(type_2, types[typeid]._definition.schema);\n                }\n                return reflection.encodeAll();\n            };\n            Reflection.decode = function (bytes, it) {\n                var context = new Context();\n                var reflection = new Reflection();\n                reflection.decode(bytes, it);\n                var schemaTypes = reflection.types.reduce(function (types, reflectionType) {\n                    var schema = /** @class */ (function (_super) {\n                        __extends(_, _super);\n                        function _() {\n                            return _super !== null && _super.apply(this, arguments) || this;\n                        }\n                        return _;\n                    }(Schema));\n                    var typeid = reflectionType.id;\n                    types[typeid] = schema;\n                    context.add(schema, typeid);\n                    return types;\n                }, {});\n                reflection.types.forEach(function (reflectionType) {\n                    var schemaType = schemaTypes[reflectionType.id];\n                    reflectionType.fields.forEach(function (field) {\n                        var _a;\n                        if (field.referencedType !== undefined) {\n                            var fieldType = field.type;\n                            var refType = schemaTypes[field.referencedType];\n                            // map or array of primitive type (-1)\n                            if (!refType) {\n                                var typeInfo = field.type.split(\":\");\n                                fieldType = typeInfo[0];\n                                refType = typeInfo[1];\n                            }\n                            if (fieldType === \"ref\") {\n                                type(refType, context)(schemaType.prototype, field.name);\n                            }\n                            else {\n                                type((_a = {}, _a[fieldType] = refType, _a), context)(schemaType.prototype, field.name);\n                            }\n                        }\n                        else {\n                            type(field.type, context)(schemaType.prototype, field.name);\n                        }\n                    });\n                });\n                var rootType = schemaTypes[reflection.rootType];\n                var rootInstance = new rootType();\n                /**\n                 * auto-initialize referenced types on root type\n                 * to allow registering listeners immediatelly on client-side\n                 */\n                for (var fieldName in rootType._definition.schema) {\n                    var fieldType = rootType._definition.schema[fieldName];\n                    if (typeof (fieldType) !== \"string\") {\n                        rootInstance[fieldName] = (typeof (fieldType) === \"function\")\n                            ? new fieldType() // is a schema reference\n                            : new (getType(Object.keys(fieldType)[0])).constructor(); // is a \"collection\"\n                    }\n                }\n                return rootInstance;\n            };\n            __decorate([\n                type([ReflectionType], reflectionContext)\n            ], Reflection.prototype, \"types\", void 0);\n            __decorate([\n                type(\"number\", reflectionContext)\n            ], Reflection.prototype, \"rootType\", void 0);\n            return Reflection;\n        }(Schema));\n\n        registerType(\"map\", { constructor: MapSchema, getProxy: getMapProxy });\n        registerType(\"array\", { constructor: ArraySchema, getProxy: getArrayProxy });\n        registerType(\"set\", { constructor: SetSchema });\n        registerType(\"collection\", { constructor: CollectionSchema, });\n\n        exports.ArraySchema = ArraySchema;\n        exports.CollectionSchema = CollectionSchema;\n        exports.Context = Context;\n        exports.MapSchema = MapSchema;\n        exports.Reflection = Reflection;\n        exports.ReflectionField = ReflectionField;\n        exports.ReflectionType = ReflectionType;\n        exports.Schema = Schema;\n        exports.SchemaDefinition = SchemaDefinition;\n        exports.SetSchema = SetSchema;\n        exports.decode = decode;\n        exports.defineTypes = defineTypes;\n        exports.deprecated = deprecated;\n        exports.dumpChanges = dumpChanges;\n        exports.encode = encode;\n        exports.filter = filter;\n        exports.filterChildren = filterChildren;\n        exports.hasFilter = hasFilter;\n        exports.registerType = registerType;\n        exports.type = type;\n\n        Object.defineProperty(exports, '__esModule', { value: true });\n\n    })));\n    });\n\n    var Room = /** @class */ (function () {\n        function Room(name, rootSchema) {\n            var _this = this;\n            // Public signals\n            this.onStateChange = createSignal();\n            this.onError = createSignal();\n            this.onLeave = createSignal();\n            this.onJoin = createSignal();\n            this.hasJoined = false;\n            this.onMessageHandlers = createNanoEvents();\n            this.id = null;\n            this.name = name;\n            if (rootSchema) {\n                this.serializer = new (getSerializer(\"schema\"));\n                this.rootSchema = rootSchema;\n                this.serializer.state = new rootSchema();\n            }\n            this.onError(function (code, message) { return console.warn(\"colyseus.js - onError => (\" + code + \") \" + message); });\n            this.onLeave(function () { return _this.removeAllListeners(); });\n        }\n        Room.prototype.connect = function (endpoint) {\n            var _this = this;\n            this.connection = new Connection();\n            this.connection.events.onmessage = this.onMessageCallback.bind(this);\n            this.connection.events.onclose = function (e) {\n                if (!_this.hasJoined) {\n                    console.warn(\"Room connection was closed unexpectedly (\" + e.code + \"): \" + e.reason);\n                    _this.onError.invoke(e.code, e.reason);\n                    return;\n                }\n                _this.onLeave.invoke(e.code);\n                _this.destroy();\n            };\n            this.connection.events.onerror = function (e) {\n                console.warn(\"Room, onError (\" + e.code + \"): \" + e.reason);\n                _this.onError.invoke(e.code, e.reason);\n            };\n            this.connection.connect(endpoint);\n        };\n        Room.prototype.leave = function (consented) {\n            if (consented === void 0) { consented = true; }\n            if (this.connection) {\n                if (consented) {\n                    this.connection.send([exports.Protocol.LEAVE_ROOM]);\n                }\n                else {\n                    this.connection.close();\n                }\n            }\n            else {\n                this.onLeave.invoke(4000); // \"consented\" code\n            }\n        };\n        Room.prototype.onMessage = function (type, callback) {\n            return this.onMessageHandlers.on(this.getMessageHandlerKey(type), callback);\n        };\n        Room.prototype.send = function (type, message) {\n            var initialBytes = [exports.Protocol.ROOM_DATA];\n            if (typeof (type) === \"string\") {\n                umd.encode.string(initialBytes, type);\n            }\n            else {\n                umd.encode.number(initialBytes, type);\n            }\n            var arr;\n            if (message !== undefined) {\n                var encoded = encode(message);\n                arr = new Uint8Array(initialBytes.length + encoded.byteLength);\n                arr.set(new Uint8Array(initialBytes), 0);\n                arr.set(new Uint8Array(encoded), initialBytes.length);\n            }\n            else {\n                arr = new Uint8Array(initialBytes);\n            }\n            this.connection.send(arr.buffer);\n        };\n        Object.defineProperty(Room.prototype, \"state\", {\n            get: function () {\n                return this.serializer.getState();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Room.prototype.removeAllListeners = function () {\n            this.onJoin.clear();\n            this.onStateChange.clear();\n            this.onError.clear();\n            this.onLeave.clear();\n            this.onMessageHandlers.events = {};\n        };\n        Room.prototype.onMessageCallback = function (event) {\n            var bytes = Array.from(new Uint8Array(event.data));\n            var code = bytes[0];\n            if (code === exports.Protocol.JOIN_ROOM) {\n                var offset = 1;\n                this.serializerId = utf8Read(bytes, offset);\n                offset += utf8Length(this.serializerId);\n                // Instantiate serializer if not locally available.\n                if (!this.serializer) {\n                    var serializer = getSerializer(this.serializerId);\n                    this.serializer = new serializer();\n                }\n                if (bytes.length > offset && this.serializer.handshake) {\n                    this.serializer.handshake(bytes, { offset: offset });\n                }\n                this.hasJoined = true;\n                this.onJoin.invoke();\n                // acknowledge successfull JOIN_ROOM\n                this.connection.send([exports.Protocol.JOIN_ROOM]);\n            }\n            else if (code === exports.Protocol.ERROR) {\n                var it_1 = { offset: 1 };\n                var code_1 = umd.decode.number(bytes, it_1);\n                var message = umd.decode.string(bytes, it_1);\n                this.onError.invoke(code_1, message);\n            }\n            else if (code === exports.Protocol.LEAVE_ROOM) {\n                this.leave();\n            }\n            else if (code === exports.Protocol.ROOM_DATA_SCHEMA) {\n                var it_2 = { offset: 1 };\n                var context_1 = this.serializer.getState().constructor._context;\n                var type = context_1.get(umd.decode.number(bytes, it_2));\n                var message = new type();\n                message.decode(bytes, it_2);\n                this.dispatchMessage(type, message);\n            }\n            else if (code === exports.Protocol.ROOM_STATE) {\n                bytes.shift(); // drop `code` byte\n                this.setState(bytes);\n            }\n            else if (code === exports.Protocol.ROOM_STATE_PATCH) {\n                bytes.shift(); // drop `code` byte\n                this.patch(bytes);\n            }\n            else if (code === exports.Protocol.ROOM_DATA) {\n                var it_3 = { offset: 1 };\n                var type = (umd.decode.stringCheck(bytes, it_3))\n                    ? umd.decode.string(bytes, it_3)\n                    : umd.decode.number(bytes, it_3);\n                var message = (bytes.length > it_3.offset)\n                    ? decode(event.data, it_3.offset)\n                    : undefined;\n                this.dispatchMessage(type, message);\n            }\n        };\n        Room.prototype.setState = function (encodedState) {\n            this.serializer.setState(encodedState);\n            this.onStateChange.invoke(this.serializer.getState());\n        };\n        Room.prototype.patch = function (binaryPatch) {\n            this.serializer.patch(binaryPatch);\n            this.onStateChange.invoke(this.serializer.getState());\n        };\n        Room.prototype.dispatchMessage = function (type, message) {\n            var messageType = this.getMessageHandlerKey(type);\n            if (this.onMessageHandlers.events[messageType]) {\n                this.onMessageHandlers.emit(messageType, message);\n            }\n            else if (this.onMessageHandlers.events['*']) {\n                this.onMessageHandlers.emit('*', type, message);\n            }\n            else {\n                console.warn(\"onMessage not registered for type '\" + type + \"'.\");\n            }\n        };\n        Room.prototype.destroy = function () {\n            if (this.serializer) {\n                this.serializer.teardown();\n            }\n        };\n        Room.prototype.getMessageHandlerKey = function (type) {\n            switch (typeof (type)) {\n                // typeof Schema\n                case \"function\": return \"$\" + type._typeid;\n                // string\n                case \"string\": return type;\n                // number\n                case \"number\": return \"i\" + type;\n                default: throw new Error(\"invalid message type.\");\n            }\n        };\n        return Room;\n    }());\n\n    /// <reference path=\"../typings/cocos-creator.d.ts\" />\n    /**\n     * We do not assign 'storage' to window.localStorage immediatelly for React\n     * Native compatibility. window.localStorage is not present when this module is\n     * loaded.\n     */\n    var storage;\n    function getStorage() {\n        if (!storage) {\n            storage = (typeof (cc) !== 'undefined' && cc.sys && cc.sys.localStorage)\n                ? cc.sys.localStorage // compatibility with cocos creator\n                : typeof (window) !== \"undefined\" && window.localStorage //RN does have window object at this point, but localStorage is not defined\n                    ? window.localStorage // regular browser environment\n                    : {\n                        cache: {},\n                        setItem: function (key, value) { this.cache[key] = value; },\n                        getItem: function (key) { this.cache[key]; },\n                        removeItem: function (key) { delete this.cache[key]; },\n                    };\n        }\n        return storage;\n    }\n    function setItem(key, value) {\n        getStorage().setItem(key, value);\n    }\n    function removeItem(key) {\n        getStorage().removeItem(key);\n    }\n    function getItem(key, callback) {\n        var value = getStorage().getItem(key);\n        if (typeof (Promise) === 'undefined' || // old browsers\n            !(value instanceof Promise)) {\n            // browser has synchronous return\n            callback(value);\n        }\n        else {\n            // react-native is asynchronous\n            value.then(function (id) { return callback(id); });\n        }\n    }\n\n    var TOKEN_STORAGE = \"colyseus-auth-token\";\n    exports.Platform = void 0;\n    (function (Platform) {\n        Platform[\"ios\"] = \"ios\";\n        Platform[\"android\"] = \"android\";\n    })(exports.Platform || (exports.Platform = {}));\n    var Auth = /** @class */ (function () {\n        function Auth(endpoint) {\n            var _this = this;\n            this._id = undefined;\n            this.username = undefined;\n            this.displayName = undefined;\n            this.avatarUrl = undefined;\n            this.isAnonymous = undefined;\n            this.email = undefined;\n            this.lang = undefined;\n            this.location = undefined;\n            this.timezone = undefined;\n            this.metadata = undefined;\n            this.devices = undefined;\n            this.facebookId = undefined;\n            this.twitterId = undefined;\n            this.googleId = undefined;\n            this.gameCenterId = undefined;\n            this.steamId = undefined;\n            this.friendIds = undefined;\n            this.blockedUserIds = undefined;\n            this.createdAt = undefined;\n            this.updatedAt = undefined;\n            // auth token\n            this.token = undefined;\n            this.endpoint = endpoint.replace(\"ws\", \"http\");\n            getItem(TOKEN_STORAGE, function (token) { return _this.token = token; });\n        }\n        Object.defineProperty(Auth.prototype, \"hasToken\", {\n            get: function () {\n                return !!this.token;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Auth.prototype.login = function (options) {\n            if (options === void 0) { options = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                var queryParams, data, attr;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            queryParams = Object.assign({}, options);\n                            if (this.hasToken) {\n                                queryParams.token = this.token;\n                            }\n                            return [4 /*yield*/, this.request('post', '/auth', queryParams)];\n                        case 1:\n                            data = _a.sent();\n                            // set & cache token\n                            this.token = data.token;\n                            setItem(TOKEN_STORAGE, this.token);\n                            for (attr in data) {\n                                if (this.hasOwnProperty(attr)) {\n                                    this[attr] = data[attr];\n                                }\n                            }\n                            this.registerPingService();\n                            return [2 /*return*/, this];\n                    }\n                });\n            });\n        };\n        Auth.prototype.save = function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('put', '/auth', {}, {\n                                username: this.username,\n                                displayName: this.displayName,\n                                avatarUrl: this.avatarUrl,\n                                lang: this.lang,\n                                location: this.location,\n                                timezone: this.timezone,\n                            })];\n                        case 1:\n                            _a.sent();\n                            return [2 /*return*/, this];\n                    }\n                });\n            });\n        };\n        Auth.prototype.getFriends = function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('get', '/friends/all')];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.getOnlineFriends = function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('get', '/friends/online')];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.getFriendRequests = function () {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('get', '/friends/requests')];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.sendFriendRequest = function (friendId) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('post', '/friends/requests', { userId: friendId })];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.acceptFriendRequest = function (friendId) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('put', '/friends/requests', { userId: friendId })];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.declineFriendRequest = function (friendId) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('del', '/friends/requests', { userId: friendId })];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.blockUser = function (friendId) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('post', '/friends/block', { userId: friendId })];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.unblockUser = function (friendId) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.request('put', '/friends/block', { userId: friendId })];\n                        case 1: return [2 /*return*/, (_a.sent())];\n                    }\n                });\n            });\n        };\n        Auth.prototype.request = function (method, segments, query, body, headers) {\n            if (query === void 0) { query = {}; }\n            if (headers === void 0) { headers = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                var queryParams, name_1, queryString, opts;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            headers['Accept'] = 'application/json';\n                            if (this.hasToken) {\n                                headers['Authorization'] = 'Bearer ' + this.token;\n                            }\n                            queryParams = [];\n                            for (name_1 in query) {\n                                queryParams.push(name_1 + \"=\" + query[name_1]);\n                            }\n                            queryString = (queryParams.length > 0)\n                                ? \"?\" + queryParams.join(\"&\")\n                                : '';\n                            opts = { headers: headers };\n                            if (body) {\n                                opts.body = body;\n                            }\n                            return [4 /*yield*/, http[method](\"\" + this.endpoint + segments + queryString, opts)];\n                        case 1: return [2 /*return*/, (_a.sent()).data];\n                    }\n                });\n            });\n        };\n        Auth.prototype.logout = function () {\n            this.token = undefined;\n            removeItem(TOKEN_STORAGE);\n            this.unregisterPingService();\n        };\n        Auth.prototype.registerPingService = function (timeout) {\n            var _this = this;\n            if (timeout === void 0) { timeout = 15000; }\n            this.unregisterPingService();\n            this.keepOnlineInterval = setInterval(function () { return _this.request('get', '/auth'); }, timeout);\n        };\n        Auth.prototype.unregisterPingService = function () {\n            clearInterval(this.keepOnlineInterval);\n        };\n        return Auth;\n    }());\n\n    var _a;\n    var MatchMakeError = /** @class */ (function (_super) {\n        __extends(MatchMakeError, _super);\n        function MatchMakeError(message, code) {\n            var _this = _super.call(this, message) || this;\n            _this.code = code;\n            Object.setPrototypeOf(_this, MatchMakeError.prototype);\n            return _this;\n        }\n        return MatchMakeError;\n    }(Error));\n    // - React Native does not provide `window.location`\n    // - Cocos Creator (Native) does not provide `window.location.hostname` \n    var DEFAULT_ENDPOINT = (typeof (window) !== \"undefined\" && typeof ((_a = window === null || window === void 0 ? void 0 : window.location) === null || _a === void 0 ? void 0 : _a.hostname) !== \"undefined\")\n        ? window.location.protocol.replace(\"http\", \"ws\") + \"//\" + window.location.hostname + (window.location.port && \":\" + window.location.port)\n        : \"ws://127.0.0.1:2567\";\n    var Client = /** @class */ (function () {\n        function Client(endpoint) {\n            if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }\n            this.endpoint = endpoint;\n        }\n        Object.defineProperty(Client.prototype, \"auth\", {\n            get: function () {\n                if (!this._auth) {\n                    this._auth = new Auth(this.endpoint);\n                }\n                return this._auth;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Client.prototype.joinOrCreate = function (roomName, options, rootSchema) {\n            if (options === void 0) { options = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinOrCreate', roomName, options, rootSchema)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        };\n        Client.prototype.create = function (roomName, options, rootSchema) {\n            if (options === void 0) { options = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.createMatchMakeRequest('create', roomName, options, rootSchema)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        };\n        Client.prototype.join = function (roomName, options, rootSchema) {\n            if (options === void 0) { options = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.createMatchMakeRequest('join', roomName, options, rootSchema)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        };\n        Client.prototype.joinById = function (roomId, options, rootSchema) {\n            if (options === void 0) { options = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinById', roomId, options, rootSchema)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        };\n        Client.prototype.reconnect = function (roomId, sessionId, rootSchema) {\n            return __awaiter(this, void 0, void 0, function () {\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0: return [4 /*yield*/, this.createMatchMakeRequest('joinById', roomId, { sessionId: sessionId }, rootSchema)];\n                        case 1: return [2 /*return*/, _a.sent()];\n                    }\n                });\n            });\n        };\n        Client.prototype.getAvailableRooms = function (roomName) {\n            if (roomName === void 0) { roomName = \"\"; }\n            return __awaiter(this, void 0, void 0, function () {\n                var url;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            url = this.endpoint.replace(\"ws\", \"http\") + \"/matchmake/\" + roomName;\n                            return [4 /*yield*/, get_1(url, { headers: { 'Accept': 'application/json' } })];\n                        case 1: return [2 /*return*/, (_a.sent()).data];\n                    }\n                });\n            });\n        };\n        Client.prototype.consumeSeatReservation = function (response, rootSchema) {\n            return __awaiter(this, void 0, void 0, function () {\n                var room;\n                return __generator(this, function (_a) {\n                    room = this.createRoom(response.room.name, rootSchema);\n                    room.id = response.room.roomId;\n                    room.sessionId = response.sessionId;\n                    room.connect(this.buildEndpoint(response.room, { sessionId: room.sessionId }));\n                    return [2 /*return*/, new Promise(function (resolve, reject) {\n                            var onError = function (code, message) { return reject(new ServerError(code, message)); };\n                            room.onError.once(onError);\n                            room['onJoin'].once(function () {\n                                room.onError.remove(onError);\n                                resolve(room);\n                            });\n                        })];\n                });\n            });\n        };\n        Client.prototype.createMatchMakeRequest = function (method, roomName, options, rootSchema) {\n            if (options === void 0) { options = {}; }\n            return __awaiter(this, void 0, void 0, function () {\n                var url, response;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            url = this.endpoint.replace(\"ws\", \"http\") + \"/matchmake/\" + method + \"/\" + roomName;\n                            // automatically forward auth token, if present\n                            if (this._auth && this._auth.hasToken) {\n                                options.token = this._auth.token;\n                            }\n                            return [4 /*yield*/, post_1(url, {\n                                    headers: {\n                                        'Accept': 'application/json',\n                                        'Content-Type': 'application/json'\n                                    },\n                                    body: JSON.stringify(options)\n                                })];\n                        case 1:\n                            response = (_a.sent()).data;\n                            if (response.error) {\n                                throw new MatchMakeError(response.error, response.code);\n                            }\n                            return [2 /*return*/, this.consumeSeatReservation(response, rootSchema)];\n                    }\n                });\n            });\n        };\n        Client.prototype.createRoom = function (roomName, rootSchema) {\n            return new Room(roomName, rootSchema);\n        };\n        Client.prototype.buildEndpoint = function (room, options) {\n            if (options === void 0) { options = {}; }\n            var params = [];\n            for (var name_1 in options) {\n                if (!options.hasOwnProperty(name_1)) {\n                    continue;\n                }\n                params.push(name_1 + \"=\" + options[name_1]);\n            }\n            return this.endpoint + \"/\" + room.processId + \"/\" + room.roomId + \"?\" + params.join('&');\n        };\n        return Client;\n    }());\n\n    var SchemaSerializer = /** @class */ (function () {\n        function SchemaSerializer() {\n        }\n        SchemaSerializer.prototype.setState = function (rawState) {\n            this.state.decode(rawState);\n        };\n        SchemaSerializer.prototype.getState = function () {\n            return this.state;\n        };\n        SchemaSerializer.prototype.patch = function (patches) {\n            this.state.decode(patches);\n        };\n        SchemaSerializer.prototype.teardown = function () {\n            var _a, _b;\n            (_b = (_a = this.state) === null || _a === void 0 ? void 0 : _a['$changes']) === null || _b === void 0 ? void 0 : _b.root.clearRefs();\n        };\n        SchemaSerializer.prototype.handshake = function (bytes, it) {\n            if (this.state) {\n                // validate client/server definitinos\n                var reflection = new umd.Reflection();\n                reflection.decode(bytes, it);\n            }\n            else {\n                // initialize reflected state from server\n                this.state = umd.Reflection.decode(bytes, it);\n            }\n        };\n        return SchemaSerializer;\n    }());\n\n    var NoneSerializer = /** @class */ (function () {\n        function NoneSerializer() {\n        }\n        NoneSerializer.prototype.setState = function (rawState) { };\n        NoneSerializer.prototype.getState = function () { return null; };\n        NoneSerializer.prototype.patch = function (patches) { };\n        NoneSerializer.prototype.teardown = function () { };\n        NoneSerializer.prototype.handshake = function (bytes) { };\n        return NoneSerializer;\n    }());\n\n    registerSerializer('schema', SchemaSerializer);\n    registerSerializer('none', NoneSerializer);\n\n    exports.Auth = Auth;\n    exports.Client = Client;\n    exports.Room = Room;\n    exports.SchemaSerializer = SchemaSerializer;\n    exports.registerSerializer = registerSerializer;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=colyseus.js.map\n"]}