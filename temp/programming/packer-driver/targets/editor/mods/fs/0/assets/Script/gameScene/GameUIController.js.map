{"version":3,"sources":["file:///D:/Office/Sumo/assets/Script/gameScene/GameUIController.ts"],"names":["_decorator","Component","Node","macro","Vec3","EventHandler","ccclass","property","GameUIController","type","tooltip","start","node","on","EventType","TOUCH_MOVE","touchMove","TOUCH_START","touchStart","TOUCH_END","touchEnded","onConnect","touch","loc","getLocation","pos","x","startLoc","y","angle","get_angle","touchEventCallBack","forEach","c","emit","cx","cy","ex","ey","dy","dx","theta","Math","atan2","DEG"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAwBC,MAAAA,K,OAAAA,K;AAAoBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,Y,OAAAA,Y;;;;;;;OAE5E;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;kCAGaQ,gB,WADZF,OAAO,CAAC,kBAAD,C,UAKHC,QAAQ,CAAC;AACNE,QAAAA,IAAI,EAAE,CAACJ,YAAD,CADA;AAENK,QAAAA,OAAO,EAAE;AAFH,OAAD,C,oCALb,MACaF,gBADb,SACsCP,SADtC,CACgD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAW5CU,QAAAA,KAAK,GAAG;AACJ,eAAKC,IAAL,CAAUC,EAAV,CAAaX,IAAI,CAACY,SAAL,CAAeC,UAA5B,EAAwC,KAAKC,SAA7C,EAAwD,IAAxD;AACA,eAAKJ,IAAL,CAAUC,EAAV,CAAaX,IAAI,CAACY,SAAL,CAAeG,WAA5B,EAAyC,KAAKC,UAA9C,EAA0D,IAA1D;AACA,eAAKN,IAAL,CAAUC,EAAV,CAAaX,IAAI,CAACY,SAAL,CAAeK,SAA5B,EAAuC,KAAKC,UAA5C,EAAwD,IAAxD;AAEH;;AAEDC,QAAAA,SAAS,GAAG,CAEX;;AAEDL,QAAAA,SAAS,CAACM,KAAD,EAAoB;AACzB;AACR;AACA;AACA;AACA;AACA;AACA;AAGQ,cAAIC,GAAG,GAAGD,KAAK,CAACE,WAAN,EAAV;AACA,cAAIC,GAAG,GAAG,IAAIrB,IAAJ,CAASmB,GAAG,CAACG,CAAJ,GAAQ,KAAKC,QAAL,CAAcD,CAA/B,EAAkCH,GAAG,CAACK,CAAJ,GAAQ,KAAKD,QAAL,CAAcC,CAAxD,CAAV;AACA,cAAIC,KAAK,GAAG,KAAKC,SAAL,CAAe,KAAKH,QAAL,CAAcD,CAA7B,EAAgC,KAAKC,QAAL,CAAcC,CAA9C,EAAiDL,GAAG,CAACG,CAArD,EAAwDH,GAAG,CAACK,CAA5D,CAAZ;AACA,eAAKG,kBAAL,CAAwBC,OAAxB,CAAgCC,CAAC,IAAIA,CAAC,CAACC,IAAF,CAAO,CAACT,GAAD,EAAMI,KAAN,CAAP,CAArC;AACH;;AAEDT,QAAAA,UAAU,CAACE,KAAD,EAAoB;AAC1B,eAAKS,kBAAL,CAAwBC,OAAxB,CAAgCC,CAAC,IAAIA,CAAC,CAACC,IAAF,CAAO,CAAC,IAAI9B,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAAD,CAAP,CAArC;AACH;;AAEDc,QAAAA,UAAU,CAACI,KAAD,EAAoB;AAC1B,eAAKK,QAAL,GAAgBL,KAAK,CAACE,WAAN,EAAhB;AACA,eAAKR,SAAL,CAAeM,KAAf;AACH;;AAEDQ,QAAAA,SAAS,CAACK,EAAD,EAAaC,EAAb,EAAyBC,EAAzB,EAAqCC,EAArC,EAAiD;AACtD,cAAIC,EAAE,GAAGD,EAAE,GAAGF,EAAd;AACA,cAAII,EAAE,GAAGH,EAAE,GAAGF,EAAd;AACA,cAAIM,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWJ,EAAX,EAAeC,EAAf,CAAZ,CAHsD,CAItD;;AACA,iBAAOC,KAAK,GAAGtC,KAAK,CAACyC,GAArB;AACH;;AArD2C,O;;;;;iBAQP,E","sourcesContent":["\r\nimport { _decorator, Component, Node, Vec2, EventTouch, macro, UITransform, Vec3, EventHandler } from 'cc';\r\nimport { SocketConnection } from './multiplayer/SocketConnection';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = GameUIController\r\n * DateTime = Tue Sep 28 2021 19:04:24 GMT+0530 (India Standard Time)\r\n * Author = shashankA\r\n * FileBasename = GameUIController.ts\r\n * FileBasenameNoExtension = GameUIController\r\n * URL = db://assets/Script/GameUIController.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n\r\n@ccclass('GameUIController')\r\nexport class GameUIController extends Component {\r\n\r\n    startLoc: Vec2;\r\n\r\n    @property({\r\n        type: [EventHandler],\r\n        tooltip: 'Touch Drag'\r\n    })\r\n    touchEventCallBack: EventHandler[] = [];\r\n    socketConnection: SocketConnection;\r\n\r\n    start() {\r\n        this.node.on(Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        this.node.on(Node.EventType.TOUCH_START, this.touchStart, this);\r\n        this.node.on(Node.EventType.TOUCH_END, this.touchEnded, this);\r\n\r\n    }\r\n\r\n    onConnect() {\r\n\r\n    }\r\n\r\n    touchMove(touch: EventTouch) {\r\n        /*  \r\n        ***** Do not delete this commented code\r\n\r\n        let loc = touch.getUILocation();\r\n        let pos = this.node.getComponent(UITransform).convertToNodeSpaceAR(new Vec3(loc.x, loc.y));\r\n        let angle = Math.atan2(pos.y, pos.x);\r\n        this.touchEventCallBack.forEach(c => c.emit([pos, angle * macro.DEG])); \r\n        */\r\n\r\n        let loc = touch.getLocation();\r\n        let pos = new Vec3(loc.x - this.startLoc.x, loc.y - this.startLoc.y);\r\n        let angle = this.get_angle(this.startLoc.x, this.startLoc.y, loc.x, loc.y);\r\n        this.touchEventCallBack.forEach(c => c.emit([pos, angle]));\r\n    }\r\n\r\n    touchEnded(touch: EventTouch) {\r\n        this.touchEventCallBack.forEach(c => c.emit([new Vec3(0, 0, 0)]));\r\n    }\r\n\r\n    touchStart(touch: EventTouch) {\r\n        this.startLoc = touch.getLocation();\r\n        this.touchMove(touch);\r\n    }\r\n\r\n    get_angle(cx: number, cy: number, ex: number, ey: number) {\r\n        let dy = ey - cy;\r\n        let dx = ex - cx;\r\n        let theta = Math.atan2(dy, dx);\r\n        // theta *= 180 / Math.PI;\r\n        return theta * macro.DEG;\r\n    }\r\n\r\n}"]}